<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="generator" content="pandoc">
        <meta name="author" content="Division des enseignements en informatique" />
        <meta name="dcterms.date" content="2017-01-01" />
        <title>Python objet</title>

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="reveal.js/css/reveal.css">
		
        <!-- For syntax highlighting -->
        <style type="text/css">code{white-space: pre;}</style>
        <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
        </style>
        <link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

        <link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">


	<!-- Styles ENSG-IGN -->
	<link rel="stylesheet" href="css/ign.css">

        <!-- Printing and PDF exports -->
        <!-- If the query includes 'print-pdf', use the PDF print sheet -->
        <script type="text/javascript">
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = 'reveal.js/css/print/'+ (window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper') + '.css';
            link.media = 'print';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>

        <!--[if lt IE 9]>
        <script type="text/javascript" type="text/javascript" src="reveal.js/lib/js/html5shiv.js"></script>
        <![endif]-->
        <!-- -H/- -include-in-header -->
    </head>
    <body>
        <!-- -B/- -include-before-body -->

        <div class="reveal">

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">

                <section>
                    <h1>Python objet</h1>
                    <h3>Division des enseignements en informatique</h3>
                    <h4>2017</h4>
                </section>

                <!-- - -toc/- -table-of-contents -->

            <!-- ne pas indenter le $body$ sinon les codes (highlight) vont l'être aussi !!! -->
<section id="rappels-et-bonnes-pratiques---litération" class="level1">
<h1>Rappels et bonnes pratiques - l'itération</h1>
<section id="litération-en-python" class="level2">
<h2>L'itération en Python</h2>
<ul>
<li>Itérer sur les éléments pas sur les indices</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">liste <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">1</span>]

<span class="cf">for</span> e <span class="kw">in</span> liste:
    e <span class="op">+=</span> <span class="dv">1</span></code></pre></div>
<p></br></p>
<p><em>Est mieux que :</em></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">liste <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">1</span>]

<span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(liste)):
    liste[i] <span class="op">+=</span> <span class="dv">1</span></code></pre></div>
</section>
<section id="litération-en-python-1" class="level2">
<h2>L'itération en Python</h2>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> liste <span class="op">=</span> [<span class="dv">1</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000000</span>)]
<span class="op">&gt;&gt;&gt;</span> t_start <span class="op">=</span> time.time()
<span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> e <span class="kw">in</span> liste:
...     e <span class="op">+=</span> <span class="dv">1</span>
...
<span class="op">&gt;&gt;&gt;</span> t_stop <span class="op">=</span> time.time()
<span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(t_stop <span class="op">-</span> t_start)
<span class="fl">0.6951391696929932</span></code></pre></div>
</section>
<section id="litération-en-python-2" class="level2">
<h2>L'itération en Python</h2>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> liste <span class="op">=</span> [<span class="dv">1</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000000</span>)]
<span class="op">&gt;&gt;&gt;</span> t_start <span class="op">=</span> time.time()
<span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(liste):
...     liste[i] <span class="op">+=</span> <span class="dv">1</span>
...
<span class="op">&gt;&gt;&gt;</span> t_stop <span class="op">=</span> time.time()
<span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(t_stop <span class="op">-</span> t_start)
<span class="fl">1.4717938899993896</span></code></pre></div>
</section>
<section id="litération-en-python-3" class="level2">
<h2>L'itération en Python</h2>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> liste <span class="op">=</span> [<span class="dv">1</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000000</span>)]
<span class="op">&gt;&gt;&gt;</span> t_start <span class="op">=</span> time.time()
<span class="op">&gt;&gt;&gt;</span> i <span class="op">=</span> <span class="dv">0</span>
<span class="op">&gt;&gt;&gt;</span> <span class="cf">while</span> i <span class="op">&lt;</span> <span class="bu">len</span>(liste):
...     liste[i] <span class="op">+=</span> <span class="dv">1</span>
...     i <span class="op">+=</span> <span class="dv">1</span>
...
<span class="op">&gt;&gt;&gt;</span> t_stop <span class="op">=</span> time.time()
<span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(t_stop <span class="op">-</span> t_start)
<span class="fl">3.251149892807007</span></code></pre></div>
</section>
<section id="les-listes-de-compréhension" class="level2">
<h2>Les listes de compréhension</h2>
<ul>
<li>Appliquer un traitement sur les éléments d'un ensemble</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">nouvelle_liste <span class="op">=</span> [e<span class="op">**</span><span class="dv">2</span> <span class="cf">for</span> e <span class="kw">in</span> liste]</code></pre></div>
<p></br></p>
<p><em>Est mieux que :</em></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">nouvelle_liste <span class="op">=</span> []
<span class="cf">for</span> e <span class="kw">in</span> liste:
    nouvelle_liste.append(e<span class="op">**</span><span class="dv">2</span>)</code></pre></div>
</section>
<section id="les-listes-de-compréhension-1" class="level2">
<h2>Les listes de compréhension</h2>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> liste <span class="op">=</span> [<span class="dv">1</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000000</span>)]
<span class="op">&gt;&gt;&gt;</span> t_start <span class="op">=</span> time.time()
<span class="op">&gt;&gt;&gt;</span> liste <span class="op">=</span> [e<span class="dv">+1</span> <span class="cf">for</span> e <span class="kw">in</span> liste]
<span class="op">&gt;&gt;&gt;</span> t_stop <span class="op">=</span> time.time()
<span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(t_stop <span class="op">-</span> t_start)
<span class="fl">0.5306060314178467</span></code></pre></div>
</section>
</section>
<section id="rappels-et-bonnes-pratiques---les-fonctions" class="level1">
<h1>Rappels et bonnes pratiques - les fonctions</h1>
<section id="nombre-variable-darguments" class="level2">
<h2>Nombre variable d'arguments</h2>
<ul>
<li>Passer un nombre indéterminé d'arguments à une fonction
<ul>
<li>Utilisation de l'opérateur <code>*</code> avant l'argument : <code>*args</code></li>
<li><code>args</code> est un tuple dans la fonction</li>
</ul></li>
</ul>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> somme(<span class="op">*</span>args):
    s <span class="op">=</span> <span class="dv">0</span>
    <span class="cf">for</span> arg <span class="kw">in</span> args:
        s <span class="op">+=</span> arg
    <span class="cf">return</span> s</code></pre></div>
</section>
<section id="nombre-variable-darguments-1" class="level2">
<h2>Nombre variable d'arguments</h2>
<ul>
<li>Passer un nombre indéterminé d'arguments nommés
<ul>
<li>Utilisation de l'opérateur <code>**</code> avant l'argument : <code>**kwargs</code></li>
<li><code>kwargs</code> est un dictionnaire dans la fonction</li>
</ul></li>
</ul>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> presentation(<span class="op">**</span>kwargs):
    <span class="cf">for</span> key, val <span class="kw">in</span> kwargs:
        <span class="bu">print</span>(<span class="st">&quot;</span><span class="sc">{}</span><span class="st"> = </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(key, value))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> presentation(nom<span class="op">=</span><span class="st">&quot;Mousse&quot;</span>, prenom<span class="op">=</span><span class="st">&quot;Emma&quot;</span>, age<span class="op">=</span><span class="dv">22</span>)
age <span class="op">=</span> <span class="dv">22</span>
prenom <span class="op">=</span> Emma
nom <span class="op">=</span> Mousse</code></pre></div>
</section>
</section>
<section id="rappels-et-bonnes-pratiques---les-exceptions" class="level1">
<h1>Rappels et bonnes pratiques - les exceptions</h1>
<section id="les-messages-derreurs" class="level2">
<h2>Les messages d'erreurs</h2>
<ul>
<li>Un exemple : le fichier <code>script.py</code> contient</li>
</ul>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> une_fonction(a):
    <span class="cf">return</span> <span class="dv">1</span> <span class="op">/</span> a
 
<span class="kw">def</span> une_autre_fonction():
    une_fonction(<span class="dv">0</span>)
 
une_autre_fonction()</code></pre></div>
</section>
<section id="les-messages-derreurs-1" class="level2">
<h2>Les messages d'erreurs</h2>
<ul>
<li>Lecture du message d'erreur de bas en haut
<ul>
<li><em>pile des appels</em></li>
</ul></li>
</ul>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">Traceback (most recent call last):
  File <span class="st">&quot;script.py&quot;</span>, line <span class="dv">7</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span>
    une_autre_fonction()
  File <span class="st">&quot;script.py&quot;</span>, line <span class="dv">5</span>, <span class="kw">in</span> une_autre_fonction
    une_fonction(<span class="dv">0</span>)
  File <span class="st">&quot;script.py&quot;</span>, line <span class="dv">2</span>, <span class="kw">in</span> une_fonction
    <span class="cf">return</span> <span class="dv">1</span> <span class="op">/</span> a
<span class="pp">ZeroDivisionError</span>: division by zero</code></pre></div>
</section>
<section id="les-exceptions" class="level2">
<h2>Les exceptions</h2>
<blockquote>
<p>Mécanisme pour gérer des erreurs survenues lors de l'exécution d'un programme.</p>
</blockquote>
<ul>
<li>Apporter une solution à un problème bloquant</li>
<li>Eviter d'interrompre le programme</li>
<li>D'autres solutions, mais c'est la manière de faire en Python
<ul>
<li><em>on essaye de faire et on avisera si ça ne fonctionne pas</em></li>
</ul></li>
</ul>
</section>
<section id="soulever-une-exception" class="level2">
<h2>Soulever une exception</h2>
<ul>
<li>Mot-clé <code>raise</code></li>
<li>Signaler volontairement une anomalie quand elle se produit</li>
</ul>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> ma_fonction(age):
    <span class="cf">if</span> age <span class="op">&lt;</span> <span class="dv">0</span>:
        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;&#39;age&#39; doit etre positif !&quot;</span>)
    <span class="co"># suite de la fonction</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> ma_fonction(<span class="op">-</span><span class="dv">2</span>)
Traceback (most recent call last):
  File <span class="st">&quot;&lt;interactive input&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span>
  File <span class="st">&quot;&lt;interactive input&gt;&quot;</span>, line <span class="dv">3</span>, <span class="kw">in</span> ma_fonction
<span class="pp">ValueError</span>: <span class="st">&#39;age&#39;</span> doit etre positif <span class="op">!</span></code></pre></div>
</section>
<section id="traiter-dune-exception" class="level2">
<h2>Traiter d'une exception</h2>
<ul>
<li>Mots-clé <code>try / except</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">try</span>:
    <span class="co"># ce qui peut produire une exception</span>
<span class="cf">except</span> NomException:
    <span class="co"># ce qu&#39;il faut faire si l&#39;exception se déclanche</span></code></pre></div>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">liste <span class="op">=</span> [<span class="st">&#39;toto&#39;</span>, <span class="st">&#39;titi&#39;</span>, <span class="st">&#39;tata&#39;</span>...]
<span class="cf">try</span>:
    choix <span class="op">=</span> liste[<span class="dv">10</span> <span class="op">//</span> i]
<span class="cf">except</span> <span class="pp">ZeroDivisionError</span>:
    <span class="bu">print</span>(<span class="st">&quot;Division par zero impossible&quot;</span>)
    choix <span class="op">=</span> liste[<span class="dv">0</span>]
<span class="cf">except</span> <span class="pp">IndexError</span>:
    <span class="bu">print</span>(<span class="st">&quot;Probleme d&#39;index&quot;</span>)
    choix <span class="op">=</span> liste[<span class="bu">len</span>(liste)]</code></pre></div>
</section>
<section id="traiter-dune-exception-1" class="level2">
<h2>Traiter d'une exception</h2>
<ul>
<li><code>finally</code> et <code>else</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">try</span>:
    <span class="co"># ce qui peut produire une exception</span>
<span class="cf">except</span> NomException:
    <span class="co"># ce qu&#39;il faut faire si l&#39;exception se déclanche</span>
<span class="cf">else</span>:
    <span class="co"># ce qu&#39;il faut faire si aucune exception n&#39;a été levée</span>
<span class="cf">finally</span>:
    <span class="co"># ce qui sera exécuté dans tous les cas, qu&#39;une exception ait eu lieu ou pas</span></code></pre></div>
</section>
<section id="traiter-une-exception" class="level2">
<h2>Traiter une exception</h2>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">try</span>:
    f <span class="op">=</span> <span class="bu">open</span>(<span class="st">&#39;fichier.txt&#39;</span>, <span class="st">&#39;w&#39;</span>)
    <span class="co"># écriture dans le fichier</span>
<span class="cf">except</span> <span class="pp">IOError</span>:
    <span class="bu">print</span>(<span class="st">&quot;Probleme lors de l&#39;écriture du fichier&quot;</span>)
<span class="cf">else</span>:
    <span class="bu">print</span>(<span class="st">&quot;Ecriture OK&quot;</span>)
<span class="cf">finally</span>:
    f.close()</code></pre></div>
</section>
<section id="les-context-managers" class="level2">
<h2>Les context managers</h2>
<ul>
<li>Simplifier les choses quand la gestion des exceptions devient lourde</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">try</span>:
    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;fichier.txt&#39;</span>, <span class="st">&#39;w&#39;</span>) <span class="im">as</span> f:
        <span class="co"># écriture dans le fichier</span>
<span class="cf">except</span> (<span class="pp">IOError</span>, <span class="pp">FileNotFoundError</span>):
    <span class="co"># gérer l&#39;erreur</span></code></pre></div>
</section>
<section id="exceptions-fréquentes" class="level2">
<h2>Exceptions fréquentes</h2>
<ul>
<li>Quelques exceptions parmis les plus fréquentes :
<ul>
<li><code>NameError</code> : la variable ou fonction manipulée n'est pas déclarée</li>
<li><code>TypeError</code> : le type de la variable ne permet pas d'effectuer l'opération demandée</li>
<li><code>ValueError</code> : le type est correct, mais pas la valeur</li>
<li><code>ZeroDivisionError</code> : division par zéro</li>
<li><code>IndexError</code> : tentative d'accès à un élément d'une séquence avec un indice qui n'existe pas</li>
<li><code>KeyError</code> : tentative d'accès à un élément d'un dictionnaire avec une clé qui n'existe pas</li>
<li><code>FileNotFoundError</code> : le fichier n'existe pas</li>
<li><code>IOError</code> : erreur lors de la manipulation d'un fichier</li>
<li><code>SyntaxError</code> : erreur de syntaxe (indentation, parenthèse...)</li>
</ul></li>
</ul>
</section>
</section>
<section id="rappels-et-bonnes-pratiques---doctests" class="level1">
<h1>Rappels et bonnes pratiques - doc&amp;tests</h1>
<section id="documentation" class="level2">
<h2>Documentation</h2>
<ul>
<li>Expliquer ce que font les fonctions, classes, modules...</li>
<li>Indispensable pour rendre le code exploitable par d'autres</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> ma_fonction(a, b):
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    Ligne générale de description de ce que fait la fonction</span>

<span class="co">    Description plus détaillé, si besoin, de comment la fonction</span>
<span class="co">    fait ce qu&#39;elle fait, de ce qu&#39;elle utilise...</span>

<span class="co">    :param a: description de ce que contient a</span>
<span class="co">    :type a: type de la valeur attendue dans a</span>
<span class="co">    :param b: description de ce que contient b</span>
<span class="co">    :type b: type de la valeur attendue dans b</span>
<span class="co">    :return: description de ce que retourne la fonction</span>
<span class="co">    :returntype: type de la valeur retournée par la fonction </span>
<span class="co">    &quot;&quot;&quot;</span></code></pre></div>
</section>
<section id="les-tests-unitaires" class="level2">
<h2>Les tests unitaires</h2>
</section>
</section>
<section id="rappels-et-bonnes-pratiques---en-vrac" class="level1">
<h1>Rappels et bonnes pratiques - en vrac</h1>
<section id="modules-et-imports" class="level2">
<h2>Modules et imports</h2>
</section>
<section id="calculs-virgules-fixesflottants" class="level2">
<h2>Calculs virgules fixes/flottants</h2>
</section>
<section id="bonnes-pratiques" class="level2">
<h2>Bonnes pratiques</h2>
<ul>
<li>Utilisation de la documentation
<ul>
<li>comment utiliser une fonction ? <code>help(fonction)</code></li>
<li>quelles sont les fonctions de ce module ? <code>dir(module)</code></li>
<li>où trouver de la doc en ligne ? <a href="https://docs.python.org/3.5/" class="uri">https://docs.python.org/3.5/</a></li>
</ul></li>
</ul>
</section>
<section id="bonnes-pratiques-1" class="level2">
<h2>Bonnes pratiques</h2>
<ul>
<li><code>nom_de_variable</code>, <code>nom_de_fonction</code>, <code>NomDeClasse</code></li>
<li><code>a + b</code> (et pas <code>a+b</code>)
<ul>
<li>respecter les conventions c'est faciliter la lecture</li>
</ul></li>
<li>20 lignes max par fonction
<ul>
<li>au delà c'est rarement compréhensible !</li>
</ul></li>
<li>1 fonction = 1 tâche
<ul>
<li>découper en sous-fonction pour rendre plus compréhensible/maintenable/testable</li>
</ul></li>
<li>1 fichier = 1 classe</li>
<li>Utiliser bloc <code>if __name__ == '__main__':</code> pour exécuter le code
<ul>
<li>la console ne sauvegarde pas vos test</li>
</ul></li>
<li>Testez votre code <em>en live</em></li>
</ul>
</section>
</section>
<section id="python-objet" class="level1">
<h1>Python objet</h1>
<section id="déclaration-dune-classe" class="level2">
<h2>Déclaration d'une classe</h2>
<ul>
<li>Utilisation du mot-clé <code>class</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">class</span> MaClasse(<span class="bu">object</span>):
    ...
    ...</code></pre></div>
<ul>
<li>Convention :
<ul>
<li>1ère lettre des mots en majuscule</li>
<li>pas d'espace, tiret, underscore...</li>
<li><code>MonNomDeClasse</code></li>
</ul></li>
</ul>
</section>
<section id="instanciation-dun-objet" class="level2">
<h2>Instanciation d'un objet</h2>
<blockquote>
<p>L'objet est une instance de classe.</p>
</blockquote>
<ul>
<li>On en crée autant que l'on veut</li>
</ul>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">mon_objet1 <span class="op">=</span> MaClasse()
mon_objet2 <span class="op">=</span> MaClasse()
mon_objet3 <span class="op">=</span> MaClasse()</code></pre></div>
</section>
<section id="les-méthodes" class="level2">
<h2>Les méthodes</h2>
<blockquote>
<p>Une méthode est une fonction définie à l'intérieur d'une classe.</p>
</blockquote>
<ul>
<li>Pour l'utiliser
<ul>
<li>on fait précéder le nom de la méthode du nom de l'objet</li>
</ul></li>
</ul>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> MaClasse(<span class="bu">object</span>):
...     <span class="kw">def</span> une_methode(param):
...         <span class="bu">print</span>(<span class="st">&quot;Une méthode qui fait quelque chose&quot;</span>)
...
<span class="op">&gt;&gt;&gt;</span> mon_objet <span class="op">=</span> MaClasse()
<span class="op">&gt;&gt;&gt;</span> mon_objet.une_methode()
Une méthode qui fait quelque chose</code></pre></div>
</section>
<section id="les-méthodes-1" class="level2">
<h2>Les méthodes</h2>
<ul>
<li>Instance appelant la méthode = 1er paramètre de la méthode
<ul>
<li>nommé <code>self</code> par convention</li>
<li>spécificité de Python</li>
</ul></li>
</ul>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> MaClasse(<span class="bu">object</span>):
...     <span class="kw">def</span> une_methode(<span class="va">self</span>):
...         <span class="bu">print</span>(<span class="va">self</span>)
...
<span class="op">&gt;&gt;&gt;</span> mon_objet <span class="op">=</span> MaClasse()
<span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(mon_objet)
<span class="op">&lt;</span>__main__.DescriptionDeLObjet <span class="bu">object</span> at <span class="bn">0x059F0190</span><span class="op">&gt;</span>
<span class="op">&gt;&gt;&gt;</span> mon_objet.une_methode()
<span class="op">&lt;</span>__main__.DescriptionDeLObjet <span class="bu">object</span> at <span class="bn">0x059F0190</span><span class="op">&gt;</span></code></pre></div>
</section>
<section id="les-attributs" class="level2">
<h2>Les attributs</h2>
<blockquote>
<p>Un attribut est une variable définie à l'intérieur d'une classe.</p>
</blockquote>
<ul>
<li>Pour y accéder
<ul>
<li>on fait précéder le nom de l'attribut du nom de l'instance</li>
<li>ou de <code>self</code> si on est dans la classe</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> MaClasse(<span class="bu">object</span>):
...     <span class="kw">def</span> afficher(<span class="va">self</span>):
...         <span class="bu">print</span>(<span class="va">self</span>.un_attribut)
...
<span class="op">&gt;&gt;&gt;</span> mon_objet <span class="op">=</span> MaClasse()
<span class="op">&gt;&gt;&gt;</span> mon_objet.un_attribut <span class="op">=</span> <span class="dv">48</span>
<span class="op">&gt;&gt;&gt;</span> mon_objet.afficher()
<span class="dv">48</span>
<span class="op">&gt;&gt;&gt;</span> un_attribut  <span class="co"># n&#39;existe pas en dehors de la classe</span>
<span class="pp">NameError</span>: name <span class="st">&#39;un_attribut&#39;</span> <span class="kw">is</span> <span class="kw">not</span> defined</code></pre></div>
</section>
<section id="le-constructeur" class="level2">
<h2>Le constructeur</h2>
<ul>
<li>Méthode appelée lors de la création des objets
<ul>
<li>initialise les valeurs des attributs</li>
</ul></li>
</ul>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> MaClasse(<span class="bu">object</span>):
...     <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):
...         <span class="va">self</span>.un_attribut <span class="op">=</span> <span class="st">&quot;valeur initiale&quot;</span>
...         <span class="bu">print</span>(<span class="st">&quot;Objet créé. Attributs initialisés.&quot;</span>)
...
<span class="op">&gt;&gt;&gt;</span> mon_objet <span class="op">=</span> MaClasse()
Objet créé. Attributs initialisés.
<span class="op">&gt;&gt;&gt;</span> mon_objet.un_attribut
<span class="co">&quot;valeur initiale&quot;</span></code></pre></div>
</section>
<section id="le-constructeur-1" class="level2">
<h2>Le constructeur</h2>
<ul>
<li>Possibilité de passer des paramètres pour personnaliser les objets</li>
</ul>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> MaClasse(<span class="bu">object</span>):
...     <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, valeur):
...         <span class="va">self</span>.un_attribut <span class="op">=</span> valeur
...
<span class="op">&gt;&gt;&gt;</span> mon_objet <span class="op">=</span> MaClasse(<span class="st">&quot;valeur personnalisée&quot;</span>)
<span class="op">&gt;&gt;&gt;</span> mon_objet.un_attribut
<span class="co">&quot;valeur personnalisée&quot;</span></code></pre></div>
</section>
<section id="méthodes-spéciales" class="level2">
<h2>Méthodes spéciales</h2>
<blockquote>
<p>Nous appelerons méthodes spéciale une méthode exécutée sans qu'on ai besoin de l'appeller explicitement.</p>
</blockquote>
<ul>
<li><code>__init__()</code> par exemple</li>
<li>Leur nom commence et termine par <code>__</code> (deux underscores)</li>
<li>Utile pour personnaliser le comportement d'un objet</li>
</ul>
</section>
<section id="méthodes-spéciales-1" class="level2">
<h2>Méthodes spéciales</h2>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> MaClasse(<span class="bu">object</span>):
...     <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, valeur):
...         <span class="va">self</span>.un_attribut <span class="op">=</span> valeur
...
<span class="op">&gt;&gt;&gt;</span> mon_objet <span class="op">=</span> MaClasse(<span class="st">&quot;17&quot;</span>)
<span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(mon_objet)
<span class="op">&lt;</span>__main__.MaClasse <span class="bu">object</span> at <span class="bn">0x051D5DF0</span><span class="op">&gt;</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> MaClasse(<span class="bu">object</span>):
...     <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, valeur):
...         <span class="va">self</span>.un_attribut <span class="op">=</span> valeur
...     <span class="kw">def</span> <span class="fu">__str__</span>(<span class="va">self</span>):
...         <span class="bu">print</span>(<span class="st">&quot;Instance de MaClasse (valeur de un_attribut = </span><span class="sc">{}</span><span class="st">)&quot;</span>.<span class="bu">format</span>(<span class="va">self</span>.un_attribut)
...
<span class="op">&gt;&gt;&gt;</span> mon_objet <span class="op">=</span> MaClasse(<span class="st">&quot;17&quot;</span>)
<span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(mon_objet)
Instance de MaClasse (valeur de un_attribut <span class="op">=</span> <span class="dv">17</span>)</code></pre></div>
</section>
<section id="méthodes-spéciales-2" class="level2">
<h2>Méthodes spéciales</h2>
<ul>
<li>Quelques méthodes spéciales
<ul>
<li><code>__str__()</code> appelée suite à un <code>print(objet)</code></li>
<li><code>__add__()</code> pour pouvoir écrire <code>objet1 + objet2</code></li>
<li><code>__eq__()</code> pour pouvoir comparer deux objets (<code>objet1 == objet2</code>)</li>
<li><code>__ne__()</code> pour tester si deux objets sont différents (<code>objet1 != objet2</code>)</li>
<li><code>__len__()</code> pour pouvoir calculer <code>len(objet)</code></li>
<li>...</li>
</ul></li>
</ul>
</section>
<section id="lhéritage" class="level2">
<h2>L'héritage</h2>
<blockquote>
<p>Principe permettant de créer une classe à partir d'une autre.</p>
</blockquote>
<ul>
<li>Nom de la classe mère entre parenthèses lors de la définition
<ul>
<li><em>toutes les classes héritent de la classe <code>object</code></em></li>
</ul></li>
<li>Méthodes et attributs transmis à la classe fille</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">class</span> ClasseFille(ClasseMere):
    ...</code></pre></div>
</section>
<section id="lhéritage-1" class="level2">
<h2>L'héritage</h2>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> ClasseMere(<span class="bu">object</span>):
...     <span class="kw">def</span> une_methode(<span class="va">self</span>):
...         <span class="bu">print</span>(<span class="st">&quot;Je suis dans la classe mère&quot;</span>)
... 
<span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> ClasseFille(ClasseMere):
...     <span class="cf">pass</span>
...
<span class="op">&gt;&gt;&gt;</span> ClasseFille().une_methode()
Je suis dans la classe mère</code></pre></div>
</section>
<section id="lhéritage-2" class="level2">
<h2>L'héritage</h2>
<ul>
<li>Possibilité d'appeler une méthode de la classe mère
<ul>
<li><code>ClasseMere.methode(self, param...)</code></li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> Article(<span class="bu">object</span>):
...     <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, prix):
...         <span class="va">self</span>.prix <span class="op">=</span> prix
...
<span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> ArticleEnPromotion(Article):
...     <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, prix, rabais):
...         Article.<span class="fu">__init__</span>(<span class="va">self</span>, prix)
...         <span class="va">self</span>.prix <span class="op">*=</span> (<span class="dv">1</span> <span class="op">-</span> rabais <span class="op">/</span> <span class="dv">100</span>)
...
<span class="op">&gt;&gt;&gt;</span> Article(<span class="dv">10</span>).prix
<span class="dv">10</span>
<span class="op">&gt;&gt;&gt;</span> ArticleEnPromotion(<span class="dv">10</span>, <span class="dv">20</span>).prix
<span class="dv">8</span></code></pre></div>
</section>
<section id="le-polymorphisme" class="level2">
<h2>Le polymorphisme</h2>
<blockquote>
<p>Principe permettant de donner plusieurs définitions à une méthode.</p>
</blockquote>
<ul>
<li>Dans le cadre de l'héritage
<ul>
<li>Possibilité de redéfinir une méthode héritée</li>
<li>Python se charge de trouver la bonne méthode à utiliser lors de l'appel</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> ClasseMere(<span class="bu">object</span>):
...     <span class="kw">def</span> une_methode(<span class="va">self</span>):
...         <span class="bu">print</span>(<span class="st">&quot;Je suis dans la classe mère&quot;</span>)
... 
<span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> ClasseFille(ClasseMere):
...     <span class="kw">def</span> une_methode(<span class="va">self</span>):
...         <span class="bu">print</span>(<span class="st">&quot;Je suis dans la classe fille&quot;</span>)
...
<span class="op">&gt;&gt;&gt;</span> ClasseMere().une_methode()
Je suis dans la classe mère
<span class="op">&gt;&gt;&gt;</span> ClasseFille().une_methode()
Je suis dans la classe fille</code></pre></div>
</section>
<section id="lencapsulation" class="level2">
<h2>L'encapsulation</h2>
<blockquote>
<p>Principe visant à cacher les détails de l'implémentation à l'utilisateur</p>
</blockquote>
<ul>
<li>Notion inexistante en Python : <strong>tout est public</strong></li>
<li>Convention :
<ul>
<li><code>_</code> avant le nom de l'attribut pour faire comme s'il était privé</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> MaClasse(<span class="bu">object</span>):
...     <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, valeur1, valeur2):
...         <span class="va">self</span>.attribut_public <span class="op">=</span> valeur1
...         <span class="va">self</span>._attribut_prive <span class="op">=</span> valeur2</code></pre></div>
<p style="font-size: 16pt">
Sauf bonnes raisons, nous utiliserons toujours des attributs <em>privés</em>
</p>
</section>
<section id="lectureécriture-dattributs" class="level2">
<h2>Lecture/écriture d'attributs</h2>
<ul>
<li>Comment lire/écrire les valeurs des attributs privés ?</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">class</span> Rectangle(<span class="bu">object</span>):
    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, longueur, largeur):
        <span class="va">self</span>._longueur <span class="op">=</span> longueur
        <span class="va">self</span>._largeur <span class="op">=</span> largeur
    
    <span class="kw">def</span> get_longueur(<span class="va">self</span>):
        <span class="cf">return</span> <span class="va">self</span>._longueur

    <span class="kw">def</span> set_longueur(<span class="va">self</span>, valeur):
        <span class="cf">if</span> valeur <span class="op">&gt;=</span> <span class="va">self</span>._largeur:
            <span class="va">self</span>._longueur <span class="op">=</span> valeur
        <span class="cf">else</span>:
            <span class="va">self</span>._longueur <span class="op">=</span> <span class="va">self</span>._largeur
            <span class="va">self</span>._largeur <span class="op">=</span> valeur</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> rect <span class="op">=</span> Rectangle(<span class="dv">5</span>, <span class="dv">4</span>)
<span class="op">&gt;&gt;&gt;</span> rect.set_longueur(<span class="dv">3</span>)
<span class="op">&gt;&gt;&gt;</span> rect.get_longueur()
<span class="dv">4</span></code></pre></div>
</section>
<section id="lectureécriture-dattributs-1" class="level2">
<h2>Lecture/écriture d'attributs</h2>
<p>Ca marche, mais on voudrait faire mieux et pouvoir écrire :</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> rect <span class="op">=</span> Rectangle(<span class="dv">5</span>, <span class="dv">4</span>)
<span class="op">&gt;&gt;&gt;</span> rect.longueur <span class="op">=</span> <span class="dv">3</span>
<span class="op">&gt;&gt;&gt;</span> rect.longueur
<span class="dv">4</span></code></pre></div>
<ul>
<li>Décorateur sur les fonctions
<ul>
<li><code>@property</code> pour faire comme si la méthode était un attribut</li>
<li><code>@attribut.setter</code> pour faire comme si l'on affectait une valeur à l'attribut</li>
</ul></li>
</ul>
</section>
<section id="lectureécriture-dattributs-2" class="level2">
<h2>Lecture/écriture d'attributs</h2>
<p>Le code devient :</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">class</span> Rectangle(<span class="bu">object</span>):
    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, longueur, largeur):
        <span class="va">self</span>._longueur <span class="op">=</span> longueur
        <span class="va">self</span>._largeur <span class="op">=</span> largeur
    
    <span class="at">@property</span>
    <span class="kw">def</span> longueur(<span class="va">self</span>):
        <span class="cf">return</span> <span class="va">self</span>._longueur

    <span class="at">@longueur.setter</span>
    <span class="kw">def</span> longueur(<span class="va">self</span>, valeur):
        <span class="cf">if</span> valeur <span class="op">&gt;=</span> <span class="va">self</span>._largeur:
            <span class="va">self</span>._longueur <span class="op">=</span> valeur
        <span class="cf">else</span>:
            <span class="va">self</span>._longueur <span class="op">=</span> <span class="va">self</span>._largeur
            <span class="va">self</span>._largeur <span class="op">=</span> valeur</code></pre></div>
</section>
<section id="les-classes-abstraites" class="level2">
<h2>Les classes abstraites</h2>
<blockquote>
<p>Une classe abstraite est une classe qui ne peut être instanciée.</p>
</blockquote>
<ul>
<li>Notion inexistante en Python</li>
<li>Astuce :
<ul>
<li>lever une exception dans le constructeur</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">class</span> MaClasseAbstraite(<span class="bu">object</span>):
    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, param1, param2...):
        <span class="cf">raise</span> <span class="pp">NotImplementedError</span></code></pre></div>
</section>
</section>
<section id="bases-de-données" class="level1">
<h1>Bases de données</h1>
<section id="sqlite" class="level2">
<h2>SQLite</h2>
<ul>
<li>Moteur de BDDR</li>
<li>Moteur intégré au programme</li>
<li>BDD dans un seul fichier indépendant de la plateforme</li>
<li>Librairie standard de Python</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> sqlite3</code></pre></div>
</section>
<section id="lobjet-connection" class="level2">
<h2>L'objet connection</h2>
<ul>
<li>Représente une connection à une base de données</li>
<li>Interface pour valider (commit) ou annuler (rollback) les transactions</li>
<li>Génère les curseurs</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">conn <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">&quot;user/password@database&quot;</span>)

conn.commit()  <span class="co"># valider transaction</span>
conn.rollback()  <span class="co"># annuler transaction</span>
conn.close()  <span class="co"># fermer la connection</span></code></pre></div>
<p>syntaxe avec with</p>
</section>
<section id="lobjet-curseur" class="level2">
<h2>L'objet curseur</h2>
<ul>
<li>Représente une instruction SQL sous format texte</li>
<li>Utilisé pour parcourir les résultats d'une requête SQL</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">curs <span class="op">=</span> conn.cursor()

curs.execute(sql_string [, parameters])  <span class="co"># execute requete sql</span></code></pre></div>
</section>
<section id="les-requêtes-prises-en-charge" class="level2">
<h2>Les requêtes prises en charge</h2>
<ul>
<li>Tous types de requêtes SQL acceptés</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">curs.execute(<span class="st">&quot;CREATE TABLE ...&quot;</span>)
curs.execute(<span class="st">&quot;UPDATE ...&quot;</span>)
curs.execute(<span class="st">&quot;INSERT INTO ...&quot;</span>)
curs.execute(<span class="st">&quot;SELECT ...&quot;</span>)</code></pre></div>
</section>
<section id="passage-de-paramètres" class="level2">
<h2>Passage de paramètres</h2>
<ul>
<li>Utilisation du caractère <code>?</code></li>
<li>Valeur des paramètres sous forme de tuple</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">query <span class="op">=</span> <span class="st">&quot;SELECT nom, prenom FROM personne WHERE naissance &gt; ? AND sexe = ?&quot;</span>
curs.execute(query, (<span class="dv">2000</span>, <span class="st">&#39;M&#39;</span>))</code></pre></div>
</section>
<section id="résultats-des-requêtes-sql" class="level2">
<h2>Résultats des requêtes SQL</h2>
<ul>
<li>Séquence d'objets Python</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">curs.execute(select_query)
results <span class="op">=</span> curs.fetchall()
<span class="cf">for</span> row <span class="kw">in</span> results:
    ...</code></pre></div>
</section>
<section id="exemples" class="level2">
<h2>Exemples</h2>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> sqlite3
<span class="op">&gt;&gt;&gt;</span> conn <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">&#39;dbase1&#39;</span>)
<span class="op">&gt;&gt;&gt;</span> curs <span class="op">=</span> conn.cursor()
<span class="op">&gt;&gt;&gt;</span> curs.execute(<span class="st">&#39;insert into people values (?, ?, ?)&#39;</span>, (<span class="st">&#39;Bob&#39;</span>, <span class="st">&#39;dev&#39;</span>, <span class="dv">5000</span>))
<span class="op">&gt;&gt;&gt;</span> curs.rowcount
<span class="dv">1</span></code></pre></div>
</section>
<section id="exemples-1" class="level2">
<h2>Exemples</h2>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> rows <span class="op">=</span> [[<span class="st">&#39;Tom&#39;</span>, <span class="st">&#39;mgr&#39;</span>, <span class="dv">100000</span>],
...         [<span class="st">&#39;Kim&#39;</span>, <span class="st">&#39;adm&#39;</span>, <span class="dv">30000</span>],
...         [<span class="st">&#39;pat&#39;</span>, <span class="st">&#39;dev&#39;</span>, <span class="dv">90000</span>]]

<span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> row <span class="kw">in</span> rows:
...     curs.execute(<span class="st">&#39;insert into people values (? , ?, ?)&#39;</span>, row)
...

<span class="op">&gt;&gt;&gt;</span> conn.commit()</code></pre></div>
</section>
<section id="exemples-2" class="level2">
<h2>Exemples</h2>
<ul>
<li>Utilisation de <code>fetchall()</code> pour avoir tous les résultats d'un coup</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> curs.execute(<span class="st">&#39;select * from people&#39;</span>)
<span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> row <span class="kw">in</span> curs.fetchall():
...     <span class="bu">print</span>(row)
...
(<span class="st">&#39;Bob&#39;</span>, <span class="st">&#39;dev&#39;</span>, <span class="dv">5000</span>)
(<span class="st">&#39;Sue&#39;</span>, <span class="st">&#39;mus&#39;</span>, <span class="dv">70000</span>)
(<span class="st">&#39;Ann&#39;</span>, <span class="st">&#39;mus&#39;</span>, <span class="dv">60000</span>)
(<span class="st">&#39;Tom&#39;</span>, <span class="st">&#39;mgr&#39;</span>, <span class="dv">100000</span>)
(<span class="st">&#39;Kim&#39;</span>, <span class="st">&#39;adm&#39;</span>, <span class="dv">30000</span>)
(<span class="st">&#39;Pat&#39;</span>, <span class="st">&#39;dev&#39;</span>, <span class="dv">90000</span>)</code></pre></div>
</section>
<section id="exemples-3" class="level2">
<h2>Exemples</h2>
<ul>
<li>Possibilité de ne retenir que certaines colonnes en Python (semblable aux dictionnaires)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> curs.execute(<span class="st">&#39;select * from people&#39;</span>)
<span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> (name, job, pay) <span class="kw">in</span> curs.fetchall():
...     <span class="bu">print</span>(name, <span class="st">&#39;:&#39;</span>, pay)
...
Bob : <span class="dv">5000</span>
Sue : <span class="dv">70000</span>
Ann : <span class="dv">60000</span>
Tom : <span class="dv">100000</span>
Kim : <span class="dv">30000</span>
Pat : <span class="dv">90000</span></code></pre></div>
</section>
<section id="exemples-4" class="level2">
<h2>Exemples</h2>
<ul>
<li>Idem en utilisant la position des colonnes</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> curs.execute(<span class="st">&#39;select * from people&#39;</span>)
<span class="op">&gt;&gt;&gt;</span> names <span class="op">=</span> [rec[<span class="dv">0</span>] <span class="cf">for</span> rec <span class="kw">in</span> curs.fetchall()]
<span class="op">&gt;&gt;&gt;</span> names
[<span class="st">&#39;Bob&#39;</span>, <span class="st">&#39;Sue&#39;</span>, <span class="st">&#39;Ann&#39;</span>, <span class="st">&#39;Tom&#39;</span>, <span class="st">&#39;Kim&#39;</span>, <span class="st">&#39;Pat&#39;</span>]</code></pre></div>
</section>
<section id="exemples-5" class="level2">
<h2>Exemples</h2>
<ul>
<li>Utilisation fe <code>fetchone()</code> pour n'avoir qu'une ligne de résultat à la fois</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> curs.execute(<span class="st">&#39;select * from people&#39;</span>)
<span class="op">&gt;&gt;&gt;</span> <span class="cf">while</span> <span class="va">True</span>:
...     row <span class="op">=</span> curs.fetchone()
...     <span class="cf">if</span> <span class="kw">not</span> row:
...         <span class="cf">break</span>
...     <span class="bu">print</span>(row)
...
(<span class="st">&#39;Bob&#39;</span>, <span class="st">&#39;dev&#39;</span>, <span class="dv">5000</span>)
(<span class="st">&#39;Sue&#39;</span>, <span class="st">&#39;mus&#39;</span>, <span class="dv">70000</span>)
(<span class="st">&#39;Ann&#39;</span>, <span class="st">&#39;mus&#39;</span>, <span class="dv">60000</span>)
(<span class="st">&#39;Tom&#39;</span>, <span class="st">&#39;mgr&#39;</span>, <span class="dv">100000</span>)
(<span class="st">&#39;Kim&#39;</span>, <span class="st">&#39;adm&#39;</span>, <span class="dv">30000</span>)
(<span class="st">&#39;pat&#39;</span>, <span class="st">&#39;dev&#39;</span>, <span class="dv">90000</span>)</code></pre></div>
</section>
<section id="exemples-6" class="level2">
<h2>Exemples</h2>
<ul>
<li><code>rowcount</code> indique le nombre de lignes impactées par la requête</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> curs.execute(<span class="st">&#39;update people set pay=? where pay &lt;= ?&#39;</span>, [<span class="dv">65000</span>, <span class="dv">60000</span>])
<span class="op">&gt;&gt;&gt;</span> curs.rowcount
<span class="dv">3</span>
<span class="op">&gt;&gt;&gt;</span> curs.execute(<span class="st">&#39;select * from people&#39;</span>)
<span class="op">&gt;&gt;&gt;</span> curs.fetchall()
[(<span class="st">&#39;Bob&#39;</span>, <span class="st">&#39;dev&#39;</span>, <span class="dv">65000</span>), (<span class="st">&#39;Sue&#39;</span>, <span class="st">&#39;mus&#39;</span>, <span class="dv">70000</span>), (<span class="st">&#39;Ann&#39;</span>, <span class="st">&#39;mus&#39;</span>, <span class="dv">65000</span>), (<span class="st">&#39;Tom&#39;</span>, <span class="st">&#39;mgr&#39;</span>,
<span class="dv">100000</span>), (<span class="st">&#39;Kim&#39;</span>, <span class="st">&#39;adm&#39;</span>, <span class="dv">65000</span>), (<span class="st">&#39;pat&#39;</span>, <span class="st">&#39;dev&#39;</span>, <span class="dv">90000</span>)]</code></pre></div>
</section>
<section id="exemples-7" class="level2">
<h2>Exemples</h2>
<ul>
<li>Accès à la description des colonnes (<code>curs.description</code>)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> curs.execute(<span class="st">&#39;select * from people&#39;</span>)
<span class="op">&gt;&gt;&gt;</span> colnames <span class="op">=</span> [desc[<span class="dv">0</span>] <span class="cf">for</span> desc <span class="kw">in</span> curs.description]
<span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> row <span class="kw">in</span> curs.fetchall():
...     <span class="cf">for</span> name, value <span class="kw">in</span> <span class="bu">zip</span>(colnames, row):
...         <span class="bu">print</span>(name, <span class="st">&#39;</span><span class="ch">\t</span><span class="st">=&gt;&#39;</span>, value)
...     <span class="bu">print</span>()
...
name <span class="op">=&gt;</span> Sue
job  <span class="op">=&gt;</span> mus
pay  <span class="op">=&gt;</span> <span class="dv">70000</span>

name <span class="op">=&gt;</span> Ann
job  <span class="op">=&gt;</span> mus
pay  <span class="op">=&gt;</span> <span class="dv">65000</span></code></pre></div>
</section>
<section id="exemples-8" class="level2">
<h2>Exemples</h2>
<ul>
<li>Possible de faire en Python ce que font de grosses requêtes compliquées</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> query <span class="op">=</span> (<span class="st">&quot;select name from people where job = &#39;devel&#39; and &quot;</span>
...                <span class="st">&quot;pay &gt; (select avg(pay) from people where job = &#39;devel&#39;)&quot;</span>)
<span class="op">&gt;&gt;&gt;</span> curs.execute(query)
<span class="op">&gt;&gt;&gt;</span> curs.fetchall()
[(<span class="st">&#39;kim&#39;</span>,)]</code></pre></div>
<pre><code>&gt;&gt;&gt; curs.execute(&quot;select name, pay from people where job = &#39;devel&#39;&quot;)
&gt;&gt;&gt; result = curs.fetchall()
&gt;&gt;&gt; avg = sum(rec[1] for rec in result) / len(result)
&gt;&gt;&gt; print([rec[0] for rec in result if rec[1] &gt; avg])
[&#39;kim&#39;]</code></pre>
</section>
<section id="mapping-classes-bdd" class="level2">
<h2>Mapping classes-bdd</h2>
<ul>
<li>Classiquement
<ul>
<li>Classe = table</li>
<li>Objet = ligne</li>
<li>Attribut = colonne</li>
</ul></li>
</ul>
</section>
</section>
            </div>
        </div>

        <script type="text/javascript" src="reveal.js/lib/js/head.min.js"></script>
        <script type="text/javascript" src="reveal.js/js/reveal.js"></script>

        <script type="text/javascript">
            // Full list of configuration options available here:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                /* mettre une taille en pixel sinon l'overview ne fonctionne plus */
                width: 1024,
                height: 768,
                controls: true,                                 // Display controls in the bottom right corner
                progress: true,                                 // Display a presentation progress bar
                history: true,                                  // Push each slide change to the browser history
                center: false, // Vertical centering of slides
                minScale: 0.2, // Bounds for smallestpossible content scale
                maxScale: 1.5, // Bounds for largest possible content scale
                slideNumber: false, // Display the page number of the current slide
                autoSlide: 0, // Slide every duration milliseconds

                theme: 'default', // available themes are in /css/theme
                transition: 'default', // default/cube/page/concave/zoom/linear/fade/none

                // Optional libraries used to extend on reveal.js
                dependencies: [
                    { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    // { src: 'reveal.js/plugin/markdown/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    // { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    /* ne pas activer highlight sinon la colorisation syntaxique ne fonctionne plus ? */
                    // { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
                    { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }//,
                    // { src: 'reveal.js/plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } },
                    // { src: 'reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
                ]
            });

        </script>
        <!-- -A/- -include-after-body -->
        <!-- comme le footer contient des variables, on le met dans le gabarit car
             les variables ne sont pas interprétées via -A de pandoc -->
        <div id="slide-ign-footer">
            <div class="slide-ign-title">Python objet</div>
            <div class="slide-ign-date">2017</div>
        </div>
    </body>
</html>

