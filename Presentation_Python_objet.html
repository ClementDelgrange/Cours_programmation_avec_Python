<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="generator" content="pandoc">
        <meta name="author" content="Division des enseignements en informatique" />
        <meta name="dcterms.date" content="2017-01-01" />
        <title>Python objet</title>

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="reveal.js/css/reveal.css">
		
        <!-- For syntax highlighting -->
        <style type="text/css">code{white-space: pre;}</style>
        <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
        </style>
        <link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

        <link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">


	<!-- Styles ENSG-IGN -->
	<link rel="stylesheet" href="css/ign.css">

        <!-- Printing and PDF exports -->
        <!-- If the query includes 'print-pdf', use the PDF print sheet -->
        <script type="text/javascript">
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = 'reveal.js/css/print/'+ (window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper') + '.css';
            link.media = 'print';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>

        <!--[if lt IE 9]>
        <script type="text/javascript" type="text/javascript" src="reveal.js/lib/js/html5shiv.js"></script>
        <![endif]-->
        <!-- -H/- -include-in-header -->
    </head>
    <body>
        <!-- -B/- -include-before-body -->

        <div class="reveal">

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">

                <section>
                    <h1>Python objet</h1>
                    <h3>Division des enseignements en informatique</h3>
                    <h4>2017</h4>
                </section>

                <!-- - -toc/- -table-of-contents -->

            <!-- ne pas indenter le $body$ sinon les codes (highlight) vont l'être aussi !!! -->
<section id="rappels-et-bonnes-pratiques---litération" class="level1">
<h1>Rappels et bonnes pratiques - l'itération</h1>
<section id="litération-en-python" class="level2">
<h2>L'itération en Python</h2>
<ul>
<li>Itérer sur les éléments pas sur les indices</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">liste = [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">1</span>]

<span class="kw">for</span> e in liste:
    e += <span class="dv">1</span></code></pre>
<p></br></p>
<p><em>Est mieux que :</em></p>
<pre class="sourceCode python"><code class="sourceCode python">liste = [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">1</span>]

<span class="kw">for</span> i in <span class="dt">range</span>(<span class="dt">len</span>(liste)):
    liste[i] += <span class="dv">1</span></code></pre>
</section>
<section id="litération-en-python-1" class="level2">
<h2>L'itération en Python</h2>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; liste = [<span class="dv">1</span> <span class="kw">for</span> i in <span class="dt">range</span>(<span class="dv">10000000</span>)]
&gt;&gt;&gt; t_start = time.time()
&gt;&gt;&gt; <span class="kw">for</span> e in liste:
...     e += <span class="dv">1</span>
...
&gt;&gt;&gt; t_stop = time.time()
&gt;&gt;&gt; <span class="dt">print</span>(t_stop - t_start)
<span class="fl">0.6951391696929932</span></code></pre>
</section>
<section id="litération-en-python-2" class="level2">
<h2>L'itération en Python</h2>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; liste = [<span class="dv">1</span> <span class="kw">for</span> i in <span class="dt">range</span>(<span class="dv">10000000</span>)]
&gt;&gt;&gt; t_start = time.time()
&gt;&gt;&gt; <span class="kw">for</span> i in <span class="dt">range</span>(<span class="dt">len</span>(liste):
...     liste[i] += <span class="dv">1</span>
...
&gt;&gt;&gt; t_stop = time.time()
&gt;&gt;&gt; <span class="dt">print</span>(t_stop - t_start)
<span class="fl">1.4717938899993896</span></code></pre>
</section>
<section id="litération-en-python-3" class="level2">
<h2>L'itération en Python</h2>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; liste = [<span class="dv">1</span> <span class="kw">for</span> i in <span class="dt">range</span>(<span class="dv">10000000</span>)]
&gt;&gt;&gt; t_start = time.time()
&gt;&gt;&gt; i = <span class="dv">0</span>
&gt;&gt;&gt; <span class="kw">while</span> i &lt; <span class="dt">len</span>(liste):
...     liste[i] += <span class="dv">1</span>
...     i += <span class="dv">1</span>
...
&gt;&gt;&gt; t_stop = time.time()
&gt;&gt;&gt; <span class="dt">print</span>(t_stop - t_start)
<span class="fl">3.251149892807007</span></code></pre>
</section>
<section id="les-listes-de-compréhension" class="level2">
<h2>Les listes de compréhension</h2>
<ul>
<li>Appliquer un traitement sur les éléments d'un ensemble</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">nouvelle_liste = [e**<span class="dv">2</span> <span class="kw">for</span> e in liste]</code></pre>
<p></br></p>
<p><em>Est mieux que :</em></p>
<pre class="sourceCode python"><code class="sourceCode python">nouvelle_liste = []
<span class="kw">for</span> e in liste:
    nouvelle_liste.append(e**<span class="dv">2</span>)</code></pre>
</section>
<section id="les-listes-de-compréhension-1" class="level2">
<h2>Les listes de compréhension</h2>
<p></br></p>
<p style="font-size: 14pt">
<em>En reprenant l'exemple précédent :</em>
</p>

<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; liste = [<span class="dv">1</span> <span class="kw">for</span> i in <span class="dt">range</span>(<span class="dv">10000000</span>)]
&gt;&gt;&gt; t_start = time.time()
&gt;&gt;&gt; liste = [e<span class="dv">+1</span> <span class="kw">for</span> e in liste]
&gt;&gt;&gt; t_stop = time.time()
&gt;&gt;&gt; <span class="dt">print</span>(t_stop - t_start)
<span class="fl">0.5306060314178467</span></code></pre>
</section>
</section>
<section id="rappels-et-bonnes-pratiques---les-fonctions" class="level1">
<h1>Rappels et bonnes pratiques - les fonctions</h1>
<section id="nombre-variable-darguments" class="level2">
<h2>Nombre variable d'arguments</h2>
<ul>
<li>Passer un nombre indéterminé d'arguments à une fonction
<ul>
<li>Utilisation de l'opérateur <code>*</code> avant l'argument : <code>*args</code></li>
<li><code>args</code> est un tuple dans la fonction</li>
</ul></li>
</ul>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> somme(*args):
    s = <span class="dv">0</span>
    <span class="kw">for</span> arg in args:
        s += arg
    <span class="kw">return</span> s</code></pre>
</section>
<section id="nombre-variable-darguments-1" class="level2">
<h2>Nombre variable d'arguments</h2>
<ul>
<li>Passer un nombre indéterminé d'arguments nommés
<ul>
<li>Utilisation de l'opérateur <code>**</code> avant l'argument : <code>**kwargs</code></li>
<li><code>kwargs</code> est un dictionnaire dans la fonction</li>
</ul></li>
</ul>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> presentation(**kwargs):
    <span class="kw">for</span> key, val in kwargs:
        <span class="dt">print</span>(<span class="st">&quot;{} = {}&quot;</span>.<span class="dt">format</span>(key, value))</code></pre>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; presentation(nom=<span class="st">&quot;Mousse&quot;</span>, prenom=<span class="st">&quot;Emma&quot;</span>, age=<span class="dv">22</span>)
age = <span class="dv">22</span>
prenom = Emma
nom = Mousse</code></pre>
</section>
</section>
<section id="rappels-et-bonnes-pratiques---les-exceptions" class="level1">
<h1>Rappels et bonnes pratiques - les exceptions</h1>
<section id="les-messages-derreurs" class="level2">
<h2>Les messages d'erreurs</h2>
<ul>
<li>Un exemple : le fichier <code>script.py</code> contient</li>
</ul>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> une_fonction(a):
    <span class="kw">return</span> <span class="dv">1</span> / a
 
<span class="kw">def</span> une_autre_fonction():
    une_fonction(<span class="dv">0</span>)
 
une_autre_fonction()</code></pre>
</section>
<section id="les-messages-derreurs-1" class="level2">
<h2>Les messages d'erreurs</h2>
<ul>
<li>Lecture du message d'erreur de bas en haut
<ul>
<li><em>pile des appels</em></li>
</ul></li>
</ul>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python">Traceback (most recent call last):
  File <span class="st">&quot;script.py&quot;</span>, line <span class="dv">7</span>, in &lt;module&gt;
    une_autre_fonction()
  File <span class="st">&quot;script.py&quot;</span>, line <span class="dv">5</span>, in une_autre_fonction
    une_fonction(<span class="dv">0</span>)
  File <span class="st">&quot;script.py&quot;</span>, line <span class="dv">2</span>, in une_fonction
    <span class="kw">return</span> <span class="dv">1</span> / a
<span class="ot">ZeroDivisionError</span>: division by zero</code></pre>
</section>
<section id="les-exceptions" class="level2">
<h2>Les exceptions</h2>
<blockquote>
<p>Mécanisme pour gérer des erreurs survenues lors de l'exécution d'un programme.</p>
</blockquote>
<ul>
<li>Apporter une solution à un problème bloquant</li>
<li>Eviter d'interrompre le programme</li>
<li>D'autres solutions, mais c'est la manière de faire en Python
<ul>
<li><em>on essaye de faire et on avisera si ça ne fonctionne pas</em></li>
</ul></li>
</ul>
</section>
<section id="soulever-une-exception" class="level2">
<h2>Soulever une exception</h2>
<ul>
<li>Mot-clé <code>raise</code></li>
<li>Signaler volontairement une anomalie quand elle se produit</li>
</ul>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> ma_fonction(age):
    <span class="kw">if</span> age &lt; <span class="dv">0</span>:
        <span class="kw">raise</span> <span class="ot">ValueError</span>(<span class="st">&quot;&#39;age&#39; doit etre positif !&quot;</span>)
    <span class="co"># suite de la fonction</span></code></pre>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; ma_fonction(-<span class="dv">2</span>)
Traceback (most recent call last):
  File <span class="st">&quot;&lt;interactive input&gt;&quot;</span>, line <span class="dv">1</span>, in &lt;module&gt;
  File <span class="st">&quot;&lt;interactive input&gt;&quot;</span>, line <span class="dv">3</span>, in ma_fonction
<span class="ot">ValueError</span>: <span class="st">&#39;age&#39;</span> doit etre positif !</code></pre>
</section>
<section id="traiter-dune-exception" class="level2">
<h2>Traiter d'une exception</h2>
<ul>
<li>Mots-clé <code>try / except</code></li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">try</span>:
    <span class="co"># ce qui peut produire une exception</span>
<span class="kw">except</span> NomException:
    <span class="co"># ce qu&#39;il faut faire si l&#39;exception se déclanche</span></code></pre>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python">liste = [<span class="st">&#39;toto&#39;</span>, <span class="st">&#39;titi&#39;</span>, <span class="st">&#39;tata&#39;</span>...]
<span class="kw">try</span>:
    choix = liste[<span class="dv">10</span> // i]
<span class="kw">except</span> <span class="ot">ZeroDivisionError</span>:
    <span class="dt">print</span>(<span class="st">&quot;Division par zero impossible&quot;</span>)
    choix = liste[<span class="dv">0</span>]
<span class="kw">except</span> <span class="ot">IndexError</span>:
    <span class="dt">print</span>(<span class="st">&quot;Probleme d&#39;index&quot;</span>)
    choix = liste[<span class="dt">len</span>(liste)]</code></pre>
</section>
<section id="traiter-dune-exception-1" class="level2">
<h2>Traiter d'une exception</h2>
<ul>
<li><code>finally</code> et <code>else</code></li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">try</span>:
    <span class="co"># ce qui peut produire une exception</span>
<span class="kw">except</span> NomException:
    <span class="co"># ce qu&#39;il faut faire si l&#39;exception se déclanche</span>
<span class="kw">else</span>:
    <span class="co"># ce qu&#39;il faut faire si aucune exception n&#39;a été levée</span>
<span class="kw">finally</span>:
    <span class="co"># ce qui sera exécuté dans tous les cas, qu&#39;une exception ait eu lieu ou pas</span></code></pre>
</section>
<section id="traiter-une-exception" class="level2">
<h2>Traiter une exception</h2>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">try</span>:
    f = <span class="dt">open</span>(<span class="st">&#39;fichier.txt&#39;</span>, <span class="st">&#39;w&#39;</span>)
    <span class="co"># écriture dans le fichier</span>
<span class="kw">except</span> <span class="ot">IOError</span>:
    <span class="dt">print</span>(<span class="st">&quot;Probleme lors de l&#39;écriture du fichier&quot;</span>)
<span class="kw">else</span>:
    <span class="dt">print</span>(<span class="st">&quot;Ecriture OK&quot;</span>)
<span class="kw">finally</span>:
    f.close()</code></pre>
</section>
<section id="remarque" class="level2">
<h2>Remarque</h2>
<ul>
<li>Cas des fichiers :
<ul>
<li>Astuce contre les oublis de fermeture</li>
</ul></li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">try</span>:
    <span class="kw">with</span> <span class="dt">open</span>(<span class="st">&#39;fichier.txt&#39;</span>, <span class="st">&#39;w&#39;</span>) <span class="ch">as</span> f:
        <span class="co"># écriture dans le fichier</span>
<span class="kw">except</span> (<span class="ot">IOError</span>, <span class="ot">FileNotFoundError</span>):
    <span class="co"># gérer l&#39;erreur</span></code></pre>
</section>
<section id="exceptions-fréquentes" class="level2">
<h2>Exceptions fréquentes</h2>
<ul>
<li>Ce que signifient les exceptions courantes :
<ul>
<li><code>NameError</code>
<ul>
<li>variable ou fonction manipulée non déclarée</li>
</ul></li>
<li><code>TypeError</code>
<ul>
<li>type de la variable incohérent avec l'opération demandée</li>
</ul></li>
<li><code>ValueError</code>
<ul>
<li>le type est correct, mais pas la valeur</li>
</ul></li>
<li><code>ZeroDivisionError</code>
<ul>
<li>division par zéro</li>
</ul></li>
<li><code>IndexError</code> / <code>KeyError</code>
<ul>
<li>tentative d'accès à une séquence/dictionnaire avec un indice/clé inexistant</li>
</ul></li>
<li><code>FileNotFoundError</code>
<ul>
<li>le fichier n'existe pas</li>
</ul></li>
<li><code>IOError</code>
<ul>
<li>erreur lors de la manipulation d'un fichier</li>
</ul></li>
<li><code>SyntaxError</code>
<ul>
<li>erreur de syntaxe (indentation, parenthèse...)</li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="rappels-et-bonnes-pratiques---doctest" class="level1">
<h1>Rappels et bonnes pratiques - doc&amp;test</h1>
<section id="documentation" class="level2">
<h2>Documentation</h2>
<ul>
<li>Expliquer ce que font les fonctions, classes, modules...</li>
<li>Indispensable pour rendre le code exploitable par d'autres</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> ma_fonction(a, b):
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    Ligne générale de description de ce que fait la fonction</span>

<span class="co">    Description plus détaillé, si besoin, de comment la fonction</span>
<span class="co">    fait ce qu&#39;elle fait, de ce qu&#39;elle utilise...</span>

<span class="co">    :param a: description de ce que contient a</span>
<span class="co">    :type a: type de la valeur attendue dans a</span>
<span class="co">    :param b: description de ce que contient b</span>
<span class="co">    :type b: type de la valeur attendue dans b</span>
<span class="co">    :return: description de ce que retourne la fonction</span>
<span class="co">    :returntype: type de la valeur retournée par la fonction </span>
<span class="co">    &quot;&quot;&quot;</span></code></pre>
</section>
<section id="les-tests" class="level2">
<h2>Les tests</h2>
<blockquote>
<p>Un test est un morceau de code permettant d'en soumettre une autre et d'analyser le résultat obtenu.</p>
</blockquote>
<ul>
<li>Pourquoi tester ?
<ul>
<li>s'assurer que l'application fonctionne</li>
<li>améliorer sa qualité</li>
<li>produire une meilleure documentation du code</li>
</ul></li>
</ul>
</section>
<section id="les-tests-1" class="level2">
<h2>Les tests</h2>
<ul>
<li>Comment tester ?
<ul>
<li>automatiser les tests au maximum</li>
<li>tester la réussite, l'échec et la cohérence</li>
<li>rechercher la difficulté, proscrire les tests triviaux</li>
<li>écrire des tests déterministes</li>
<li>séparer le code des tests du code de l'application</li>
</ul></li>
</ul>
</section>
<section id="les-tests-2" class="level2">
<h2>Les tests</h2>
<ul>
<li>Quand tester ?
<ul>
<li>en cours de développement</li>
<li>tout au long de la vie de l'application</li>
<li><strong>avant le développement de l'applicaiton</strong></li>
</ul></li>
</ul>
</section>
<section id="les-tests-3" class="level2">
<h2>Les tests</h2>
<ul>
<li>Différents types de tests
<ul>
<li>tests unitaires
<ul>
<li>point de vue du développeur</li>
<li>test de chaque portion de code indépendamment</li>
<li>chaque méthode répond à sa spécification</li>
<li>traitement d'un cas particulier à la fois</li>
</ul></li>
<li>test fonctionnels
<ul>
<li>point de vue utilisateur</li>
<li>validation du fonctionnement de la totalité du système (interactions entre composants)</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="des-outils-pour-tester" class="level2">
<h2>Des outils pour tester</h2>
<ul>
<li>Librairie <code>doctest</code>
<ul>
<li>tests intégrés à la documenation</li>
<li>une ligne de test commence pas <code>&gt;&gt;&gt;</code>
<ul>
<li>appel de l'interpréteur</li>
</ul></li>
<li>ligne suivante = résultat attendu
<ul>
<li><strong>forme du résultat identique au résultat de l'appel de l'interpréteur</strong></li>
</ul></li>
</ul></li>
<li><code>unitest</code>
<ul>
<li>fonctionnalités supplémentaires pour les tests unitaires</li>
</ul></li>
</ul>
</section>
<section id="exemple" class="level2">
<h2>Exemple</h2>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> factorielle(n):
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    Retourne la factorielle de n (entier positif).</span>

<span class="co">    &gt;&gt;&gt; [factorielle(n) for n in range(6)]</span>
<span class="co">    [1, 1, 2, 6, 24, 120]</span>

<span class="co">    &gt;&gt;&gt; factorielle(-1)</span>
<span class="co">    Traceback (most recent call last):</span>
<span class="co">        ...</span>
<span class="co">    ValueError: n doit etre &gt;= 0</span>

<span class="co">    &gt;&gt;&gt; factorielle(1.5)</span>
<span class="co">    Traceback (most recent call last):</span>
<span class="co">        ...</span>
<span class="co">    ValueError: n doit etre un entier</span>

<span class="co">    &gt;&gt;&gt; factorielle(1e100)</span>
<span class="co">    Traceback (most recent call last):</span>
<span class="co">        ...</span>
<span class="co">    OverflowError: n est trop grand</span>
<span class="co">    &quot;&quot;&quot;</span></code></pre>
</section>
<section id="exemple-1" class="level2">
<h2>Exemple</h2>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; <span class="ch">import</span> doctest
&gt;&gt;&gt; doctest.testmod(module_a_tester)
TestResults(failed=<span class="dv">0</span>, attempted=<span class="dv">4</span>)</code></pre>
</section>
<section id="exemple-2" class="level2">
<h2>Exemple</h2>
<ul>
<li>Que faire si représentation du résultat n'est pas certaine ?</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> divise_par_un(n):
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    Retourne la division d&#39;un nombre entier par 1.</span>

<span class="co">    &gt;&gt;&gt; divise_par_un(4)</span>
<span class="co">    4</span>
<span class="co">    </span>
<span class="co">    &gt;&gt;&gt; divise_par_un(1.5)</span>
<span class="co">    Traceback (most recent call last):</span>
<span class="co">        ...</span>
<span class="co">    ValueError: n doit etre un entier</span>
<span class="co">    &quot;&quot;&quot;</span>
    <span class="kw">if</span> math.floor(n) != n:
        <span class="kw">raise</span> <span class="ot">ValueError</span>(<span class="st">&quot;n doit etre un entier&quot;</span>)
    <span class="kw">return</span> n / <span class="dv">1</span></code></pre>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; doctest.testmod()
Failed example:
    divise_par_un(<span class="dv">4</span>)
Expected:
    <span class="dv">4</span>
Got:
    <span class="fl">4.0</span></code></pre>
</section>
<section id="exemple-3" class="level2">
<h2>Exemple</h2>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> divise_par_un(n):
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    Retourne la division d&#39;un nombre entier par 1.</span>

<span class="co">    &gt;&gt;&gt; divise_par_un(4) == 4</span>
<span class="co">    True</span>

<span class="co">    &gt;&gt;&gt; divise_par_un(1.5)</span>
<span class="co">    Traceback (most recent call last):</span>
<span class="co">        ...</span>
<span class="co">    ValueError: n doit etre un entier</span>
<span class="co">    &quot;&quot;&quot;</span>
    <span class="kw">if</span> math.floor(n) != n:
        <span class="kw">raise</span> <span class="ot">ValueError</span>(<span class="st">&quot;n doit etre un entier&quot;</span>)
    <span class="kw">return</span> n / <span class="dv">1</span></code></pre>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; doctest.testmod()
TestResults(failed=<span class="dv">0</span>, attempted=<span class="dv">2</span>)</code></pre>
</section>
<section id="exemple-4" class="level2">
<h2>Exemple</h2>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> fabrique_un_dictionnaire(a, b, c):
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    Retourne un dictionnaire</span>

<span class="co">    &gt;&gt;&gt; dico = {&#39;a&#39;: 4, &#39;b&#39;: 2, &#39;c&#39;: 6}</span>
<span class="co">    &gt;&gt;&gt; fabrique_un_dictionnaire(4, 2, 6) == dico</span>
<span class="co">    True</span>
<span class="co">    &quot;&quot;&quot;</span>
    <span class="kw">return</span> {<span class="st">&#39;a&#39;</span>: a, <span class="st">&#39;b&#39;</span>: b, <span class="st">&#39;c&#39;</span>: c}</code></pre>
</section>
</section>
<section id="rappels-et-bonnes-pratiques---les-modules" class="level1">
<h1>Rappels et bonnes pratiques - les modules</h1>
<section id="modules-et-imports" class="level2">
<h2>Modules et imports</h2>
<ul>
<li><code>import math</code>
<ul>
<li>importe l'espace de nom du module <code>math</code></li>
<li>=&gt; <code>math.cos(x)</code></li>
</ul></li>
<li><code>from math import *</code>
<ul>
<li>importe les fonctions du module <code>math</code> dans l'espace de nom courant</li>
<li>=&gt; <code>cos(x)</code>
<ul>
<li>attention aux conflits si deux fonctions portent le même nom !</li>
</ul></li>
</ul></li>
<li><code>from math import cos</code>
<ul>
<li>import la fonction <code>cos()</code> du module <code>math</code> dans l'espace de nom courant</li>
<li>=&gt; <code>cos(x)</code></li>
</ul></li>
</ul>
</section>
<section id="modules-et-imports-1" class="level2">
<h2>Modules et imports</h2>
<ul>
<li>Python recherche les modules dans le PYTHONPATH (variable d'environnement)
<ul>
<li><code>sys.path</code> en Python</li>
</ul></li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; <span class="ch">import</span> sys
&gt;&gt;&gt; sys.path
[<span class="st">&#39;&#39;</span>,
 <span class="co">&#39;C:\\Windows\\system32\\python34.zip&#39;</span>,
 <span class="co">&#39;C:\\Python34\\Lib&#39;</span>,
 <span class="co">&#39;C:\\Python34\\DLLs&#39;</span>,
 <span class="co">&#39;C:\\Python34&#39;</span>,
 <span class="co">&#39;C:\\Python34\\lib\\site-packages&#39;</span>]</code></pre>
<ul>
<li>Contenu du PYTHONPATH :
<ul>
<li><strong>répertoire courant</strong></li>
<li><code>sites-packages</code></li>
<li>...
<ul>
<li>c'est une liste =&gt; <code>append(...)</code> possibles</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="modules-et-imports-2" class="level2">
<h2>Modules et imports</h2>
<ul>
<li>Module
<ul>
<li>Ce que l'on importe</li>
<li>Fichier <code>.py</code></li>
</ul></li>
<li>Package
<ul>
<li>Ensemble de modules</li>
<li>Répertoire contenant un fichier <code>__init__.py</code></li>
</ul></li>
</ul>
</section>
<section id="modules-et-imports-3" class="level2">
<h2>Modules et imports</h2>
<ul>
<li>Exemple</li>
</ul>
<pre><code>--repertoire_courant
   |--module1.py
   |--package
      |-- __init__.py
      |-- module2.py
      |-- module3.py
   |--repertoire
      |-- module4.py</code></pre>
<p style="font-size:16pt">
avec Python lancé depuis <code>repertoire_courant</code>
</p>

<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; <span class="ch">import</span> module1           <span class="co"># on importe module1</span>
&gt;&gt;&gt; <span class="ch">import</span> package           <span class="co"># on importe tout le package</span>
&gt;&gt;&gt; <span class="ch">import</span> package.module2   <span class="co"># on importe module2 seulement</span>
&gt;&gt;&gt; <span class="ch">import</span> repertoire
<span class="ot">ImportError</span>: No module named repertoire
&gt;&gt;&gt; <span class="ch">import</span> repertoire.module4
<span class="ot">ImportError</span>: No module named repertoire.module4
&gt;&gt;&gt; sys.path.append(<span class="st">&#39;repertoire&#39;</span>)  <span class="co"># on ajoute le répertoire au PYTHON PATH</span>
&gt;&gt;&gt; <span class="ch">import</span> module4          <span class="co"># l&#39;import du module4 fonctionne</span></code></pre>
</section>
</section>
<section id="rappels-et-bonnes-pratiques" class="level1">
<h1>Rappels et bonnes pratiques</h1>
<section id="bonnes-pratiques" class="level2">
<h2>Bonnes pratiques</h2>
<ul>
<li>Utilisation de la documentation
<ul>
<li>comment utiliser une fonction ? <code>help(fonction)</code></li>
<li>quelles sont les fonctions de ce module ? <code>dir(module)</code></li>
<li>où trouver de la doc en ligne ? <a href="https://docs.python.org/3.5/">https://docs.python.org/3.5/</a></li>
</ul></li>
</ul>
</section>
<section id="bonnes-pratiques-1" class="level2">
<h2>Bonnes pratiques</h2>
<ul>
<li>20 lignes max par fonction
<ul>
<li>au delà cela devient souvent trop compliqué !</li>
</ul></li>
<li>1 fonction = 1 tâche
<ul>
<li>découper en sous-fonctions pour rendre maintenable et testable</li>
</ul></li>
<li>1 fichier = 1 classe
<ul>
<li>séparer les éléments qui ne sont pas liés</li>
</ul></li>
<li>Utiliser <code>if __name__ == '__main__':</code> pour exécuter le code
<ul>
<li>la console ne sauvegarde pas vos tests</li>
<li>code à la racine exécuté lors d'un import</li>
</ul></li>
<li>Testez votre code <em>en live</em>
<ul>
<li>profitez que Python ne soit pas compilé pour exécuter facilement le code</li>
</ul></li>
</ul>
</section>
<section id="conventions" class="level2">
<h2>Conventions</h2>
<center>
<font color="green">JAUNE</font> <font color="red">BLEU</font> <font color="blue">ORANGE</font></br> <font color="yellow">NOIR</font> <font color="blue">ROUGE</font> <font color="black">VERT</font></br> <font color="red">VIOLET</font> <font color="blue">JAUNE</font> <font color="green">ROUGE</font></br> <font color="black">ORANGE</font> <font color="red">VERT</font> <font color="yellow">NOIR</font></br> <font color="green">BLEU</font> <font color="blue">ROUGE</font> <font color="black">VIOLET</font></br> <font color="blue">VERT</font> <font color="red">BLEU</font> <font color="green">ORANGE</font></br> </br>
</center>

<p>=&gt; Respecter les conventions c'est faciliter la lecture et la compréhension</p>
</section>
<section id="conventions-1" class="level2">
<h2>Conventions</h2>
<ul>
<li>Nommage des variables</li>
</ul>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python">nom_de_variable
nom_de_fonction
NomDeClasse
NOM_DE_CONSTANTE</code></pre>
</section>
<section id="conventions-2" class="level2">
<h2>Conventions</h2>
<pre class="sourceCode python"><code class="sourceCode python">a = b + c*d</code></pre>
<p></br></p>
<p><em>Est mieux que :</em></p>
<pre class="sourceCode python"><code class="sourceCode python">a=b+c*d</code></pre>
<p></br></p>
<ul>
<li>Opérateurs entourés d'espaces pour indiquer les priorités</li>
</ul>
</section>
<section id="conventions-3" class="level2">
<h2>Conventions</h2>
<pre class="sourceCode python"><code class="sourceCode python"><span class="dt">dict</span> = {<span class="st">&#39;a&#39;</span>: <span class="dv">1</span>, <span class="st">&#39;b&#39;</span>: <span class="dv">2</span>, <span class="st">&#39;c&#39;</span>: <span class="dv">3</span>*<span class="dv">4</span>}</code></pre>
<p></br></p>
<p><em>Est mieux que :</em></p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="dt">dict</span>={<span class="st">&#39;a&#39;</span>:<span class="dv">1</span> , <span class="st">&#39;b&#39;</span>:<span class="dv">2</span>,<span class="st">&#39;c&#39;</span>:<span class="dv">3</span> * <span class="dv">4</span>}</code></pre>
<p></br></p>
<ul>
<li>Pas d'espace avant les <code>:</code> ou les <code>,</code> mais un après</li>
</ul>
</section>
<section id="conventions-4" class="level2">
<h2>Conventions</h2>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ch">import</span> module


<span class="kw">def</span> fonction_qui_compare(a, b=<span class="dv">0</span>):
    <span class="kw">if</span> a &gt; b:
        <span class="kw">return</span> <span class="ot">True</span>
    <span class="kw">else</span>:
        <span class="kw">return</span> <span class="ot">False</span></code></pre>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ch">import</span> module

<span class="kw">def</span> fonctionQuiCompare ( a , b = <span class="dv">0</span> ) :

    <span class="kw">if</span> ( a&gt;b ) :
        <span class="kw">return</span> <span class="ot">True</span>

    <span class="kw">else</span> : <span class="kw">return</span> <span class="ot">False</span></code></pre>
<p><small> - Pas d'espace autour du <code>=</code> pour les valeurs par défaut</br> - Deux sauts de ligne après les imports</br> - Pas de saut de ligne après la signature d'une fonction</br> - Pas de parenthèses inutiles</br> - Structure de code régulière</br> </small></p>
</section>
<section id="conventions-5" class="level2">
<h2>Conventions</h2>
<pre class="sourceCode python"><code class="sourceCode python">OFFSET = <span class="dv">4</span>

<span class="kw">def</span> une_fonction(tab, k):
    <span class="kw">return</span> tab[k + OFFSET]</code></pre>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python">i = <span class="dv">4</span>

<span class="kw">def</span> une_fonction(tab, K) :
    <span class="kw">return</span> tab[K + i]</code></pre>
<p></br></p>
<ul>
<li>Respect des conventions de nommage des variables</li>
<li>Noms de variable évidents</li>
</ul>
</section>
</section>
<section id="python-objet" class="level1">
<h1>Python objet</h1>
<section id="déclaration-dune-classe" class="level2">
<h2>Déclaration d'une classe</h2>
<ul>
<li>Utilisation du mot-clé <code>class</code></li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">class</span> MaClasse(<span class="dt">object</span>):
    ...
    ...</code></pre>
<ul>
<li>Convention :
<ul>
<li>1ère lettre des mots en majuscule</li>
<li>pas d'espace, tiret, underscore...</li>
<li><code>MonNomDeClasse</code></li>
</ul></li>
</ul>
</section>
<section id="instanciation-dun-objet" class="level2">
<h2>Instanciation d'un objet</h2>
<blockquote>
<p>L'objet est une instance de classe.</p>
</blockquote>
<ul>
<li>On en crée autant que l'on veut</li>
</ul>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python">mon_objet1 = MaClasse()
mon_objet2 = MaClasse()
mon_objet3 = MaClasse()</code></pre>
</section>
<section id="les-méthodes" class="level2">
<h2>Les méthodes</h2>
<blockquote>
<p>Une méthode est une fonction définie à l'intérieur d'une classe.</p>
</blockquote>
<ul>
<li>Pour l'utiliser
<ul>
<li>on fait précéder le nom de la méthode du nom de l'objet</li>
</ul></li>
</ul>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; <span class="kw">class</span> MaClasse(<span class="dt">object</span>):
...     <span class="kw">def</span> une_methode(param):
...         <span class="dt">print</span>(<span class="st">&quot;Une méthode qui fait quelque chose&quot;</span>)
...
&gt;&gt;&gt; mon_objet = MaClasse()
&gt;&gt;&gt; mon_objet.une_methode()
Une méthode qui fait quelque chose</code></pre>
</section>
<section id="les-méthodes-1" class="level2">
<h2>Les méthodes</h2>
<ul>
<li>Instance appelant la méthode = 1er paramètre de la méthode
<ul>
<li>nommé <code>self</code> par convention</li>
<li>spécificité de Python</li>
</ul></li>
</ul>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; <span class="kw">class</span> MaClasse(<span class="dt">object</span>):
...     <span class="kw">def</span> une_methode(<span class="ot">self</span>):
...         <span class="dt">print</span>(<span class="ot">self</span>)
...
&gt;&gt;&gt; mon_objet = MaClasse()
&gt;&gt;&gt; <span class="dt">print</span>(mon_objet)
&lt;__main__.DescriptionDeLObjet <span class="dt">object</span> at <span class="bn">0x059F0190</span>&gt;
&gt;&gt;&gt; mon_objet.une_methode()
&lt;__main__.DescriptionDeLObjet <span class="dt">object</span> at <span class="bn">0x059F0190</span>&gt;</code></pre>
</section>
<section id="les-attributs" class="level2">
<h2>Les attributs</h2>
<blockquote>
<p>Un attribut est une variable définie à l'intérieur d'une classe.</p>
</blockquote>
<ul>
<li>Pour y accéder
<ul>
<li>on fait précéder le nom de l'attribut du nom de l'instance</li>
<li>ou de <code>self</code> si on est dans la classe</li>
</ul></li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; <span class="kw">class</span> MaClasse(<span class="dt">object</span>):
...     <span class="kw">def</span> afficher(<span class="ot">self</span>):
...         <span class="dt">print</span>(<span class="ot">self</span>.un_attribut)
...
&gt;&gt;&gt; mon_objet = MaClasse()
&gt;&gt;&gt; mon_objet.un_attribut = <span class="dv">48</span>
&gt;&gt;&gt; mon_objet.afficher()
<span class="dv">48</span>
&gt;&gt;&gt; un_attribut  <span class="co"># n&#39;existe pas en dehors de la classe</span>
<span class="ot">NameError</span>: name <span class="st">&#39;un_attribut&#39;</span> is not defined</code></pre>
</section>
<section id="le-constructeur" class="level2">
<h2>Le constructeur</h2>
<ul>
<li>Méthode appelée lors de la création des objets
<ul>
<li>initialise les valeurs des attributs</li>
</ul></li>
</ul>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; <span class="kw">class</span> MaClasse(<span class="dt">object</span>):
...     <span class="kw">def</span> <span class="ot">__init__</span>(<span class="ot">self</span>):
...         <span class="ot">self</span>.un_attribut = <span class="st">&quot;valeur initiale&quot;</span>
...         <span class="dt">print</span>(<span class="st">&quot;Objet créé. Attributs initialisés.&quot;</span>)
...
&gt;&gt;&gt; mon_objet = MaClasse()
Objet créé. Attributs initialisés.
&gt;&gt;&gt; mon_objet.un_attribut
<span class="co">&quot;valeur initiale&quot;</span></code></pre>
</section>
<section id="le-constructeur-1" class="level2">
<h2>Le constructeur</h2>
<ul>
<li>Possibilité de passer des paramètres pour personnaliser les objets</li>
</ul>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; <span class="kw">class</span> MaClasse(<span class="dt">object</span>):
...     <span class="kw">def</span> <span class="ot">__init__</span>(<span class="ot">self</span>, valeur):
...         <span class="ot">self</span>.un_attribut = valeur
...
&gt;&gt;&gt; mon_objet = MaClasse(<span class="st">&quot;valeur personnalisée&quot;</span>)
&gt;&gt;&gt; mon_objet.un_attribut
<span class="co">&quot;valeur personnalisée&quot;</span></code></pre>
</section>
<section id="méthodes-spéciales" class="level2">
<h2>Méthodes spéciales</h2>
<blockquote>
<p>Nous appelerons méthodes spéciale une méthode exécutée sans qu'on ai besoin de l'appeller explicitement.</p>
</blockquote>
<ul>
<li><code>__init__()</code> par exemple</li>
<li>Leur nom commence et termine par <code>__</code> (deux underscores)</li>
<li>Utile pour personnaliser le comportement d'un objet</li>
</ul>
</section>
<section id="méthodes-spéciales-1" class="level2">
<h2>Méthodes spéciales</h2>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; <span class="kw">class</span> MaClasse(<span class="dt">object</span>):
...     <span class="kw">def</span> <span class="ot">__init__</span>(<span class="ot">self</span>, valeur):
...         <span class="ot">self</span>.un_attribut = valeur
...
&gt;&gt;&gt; mon_objet = MaClasse(<span class="st">&quot;17&quot;</span>)
&gt;&gt;&gt; <span class="dt">print</span>(mon_objet)
&lt;__main__.MaClasse <span class="dt">object</span> at <span class="bn">0x051D5DF0</span>&gt;</code></pre>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; <span class="kw">class</span> MaClasse(<span class="dt">object</span>):
...     <span class="kw">def</span> <span class="ot">__init__</span>(<span class="ot">self</span>, valeur):
...         <span class="ot">self</span>.un_attribut = valeur
...     <span class="kw">def</span> <span class="ot">__str__</span>(<span class="ot">self</span>):
...         <span class="dt">print</span>(<span class="st">&quot;Instance de MaClasse (valeur de un_attribut = {})&quot;</span>.<span class="dt">format</span>(<span class="ot">self</span>.un_attribut)
...
&gt;&gt;&gt; mon_objet = MaClasse(<span class="st">&quot;17&quot;</span>)
&gt;&gt;&gt; <span class="dt">print</span>(mon_objet)
Instance de MaClasse (valeur de un_attribut = <span class="dv">17</span>)</code></pre>
</section>
<section id="méthodes-spéciales-2" class="level2">
<h2>Méthodes spéciales</h2>
<ul>
<li>Quelques méthodes spéciales
<ul>
<li><code>__str__()</code> appelée suite à un <code>print(objet)</code></li>
<li><code>__add__()</code> pour pouvoir écrire <code>objet1 + objet2</code></li>
<li><code>__eq__()</code> pour pouvoir comparer deux objets (<code>objet1 == objet2</code>)</li>
<li><code>__ne__()</code> pour tester si deux objets sont différents (<code>objet1 != objet2</code>)</li>
<li><code>__len__()</code> pour pouvoir calculer <code>len(objet)</code></li>
<li>...</li>
</ul></li>
</ul>
</section>
<section id="lhéritage" class="level2">
<h2>L'héritage</h2>
<blockquote>
<p>Principe permettant de créer une classe à partir d'une autre.</p>
</blockquote>
<ul>
<li>Nom de la classe mère entre parenthèses lors de la définition
<ul>
<li><em>toutes les classes héritent (indirectement) d'une classe <code>object</code></em></li>
</ul></li>
<li>Méthodes et attributs transmis à la classe fille</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">class</span> ClasseFille(ClasseMere):
    ...</code></pre>
</section>
<section id="lhéritage-1" class="level2">
<h2>L'héritage</h2>
<p></br></p>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; <span class="kw">class</span> ClasseMere(<span class="dt">object</span>):
...     <span class="kw">def</span> une_methode(<span class="ot">self</span>):
...         <span class="dt">print</span>(<span class="st">&quot;Je suis dans la classe mère&quot;</span>)
... 
&gt;&gt;&gt; <span class="kw">class</span> ClasseFille(ClasseMere):
...     <span class="kw">pass</span>
...
&gt;&gt;&gt; ClasseFille().une_methode()
Je suis dans la classe mère</code></pre>
</section>
<section id="lhéritage-2" class="level2">
<h2>L'héritage</h2>
<ul>
<li>Possibilité d'appeler une méthode de la classe mère
<ul>
<li><code>ClasseMere.methode(self, param...)</code></li>
</ul></li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; <span class="kw">class</span> Article(<span class="dt">object</span>):
...     <span class="kw">def</span> <span class="ot">__init__</span>(<span class="ot">self</span>, prix):
...         <span class="ot">self</span>.prix = prix
...
&gt;&gt;&gt; <span class="kw">class</span> ArticleEnPromotion(Article):
...     <span class="kw">def</span> <span class="ot">__init__</span>(<span class="ot">self</span>, prix, rabais):
...         Article.<span class="ot">__init__</span>(<span class="ot">self</span>, prix)
...         <span class="ot">self</span>.prix *= (<span class="dv">1</span> - rabais / <span class="dv">100</span>)
...
&gt;&gt;&gt; Article(<span class="dv">10</span>).prix
<span class="dv">10</span>
&gt;&gt;&gt; ArticleEnPromotion(<span class="dv">10</span>, <span class="dv">20</span>).prix
<span class="dv">8</span></code></pre>
</section>
<section id="le-polymorphisme" class="level2">
<h2>Le polymorphisme</h2>
<blockquote>
<p>Principe permettant de donner plusieurs définitions à une méthode.</p>
</blockquote>
<ul>
<li>Dans le cadre de l'héritage
<ul>
<li>Possibilité de redéfinir une méthode héritée</li>
<li>Python se charge de trouver la bonne méthode à utiliser lors de l'appel</li>
</ul></li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; <span class="kw">class</span> ClasseMere(<span class="dt">object</span>):
...     <span class="kw">def</span> une_methode(<span class="ot">self</span>):
...         <span class="dt">print</span>(<span class="st">&quot;Je suis dans la classe mère&quot;</span>)
... 
&gt;&gt;&gt; <span class="kw">class</span> ClasseFille(ClasseMere):
...     <span class="kw">def</span> une_methode(<span class="ot">self</span>):
...         <span class="dt">print</span>(<span class="st">&quot;Je suis dans la classe fille&quot;</span>)
...
&gt;&gt;&gt; ClasseMere().une_methode()
Je suis dans la classe mère
&gt;&gt;&gt; ClasseFille().une_methode()
Je suis dans la classe fille</code></pre>
</section>
<section id="lencapsulation" class="level2">
<h2>L'encapsulation</h2>
<blockquote>
<p>Principe visant à cacher les détails de l'implémentation à l'utilisateur</p>
</blockquote>
<ul>
<li>Notion inexistante en Python : <strong>tout est public</strong></li>
<li>Convention :
<ul>
<li><code>_</code> avant le nom de l'attribut pour faire comme s'il était privé</li>
</ul></li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; <span class="kw">class</span> MaClasse(<span class="dt">object</span>):
...     <span class="kw">def</span> <span class="ot">__init__</span>(<span class="ot">self</span>, valeur1, valeur2):
...         <span class="ot">self</span>.attribut_public = valeur1
...         <span class="ot">self</span>._attribut_prive = valeur2</code></pre>
</section>
<section id="lectureécriture-dattributs" class="level2">
<h2>Lecture/écriture d'attributs</h2>
<ul>
<li>Comment lire/écrire les valeurs des attributs privés ?
<ul>
<li>Utiliser des méthodes spécifiques</li>
</ul></li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">class</span> Rectangle(<span class="dt">object</span>):
    <span class="kw">def</span> <span class="ot">__init__</span>(<span class="ot">self</span>, longueur, largeur):
        <span class="ot">self</span>._longueur = longueur
        <span class="ot">self</span>._largeur = largeur
    
    <span class="kw">def</span> get_longueur(<span class="ot">self</span>):
        <span class="kw">return</span> <span class="ot">self</span>._longueur

    <span class="kw">def</span> set_longueur(<span class="ot">self</span>, valeur):
        <span class="kw">if</span> valeur &gt;= <span class="ot">self</span>._largeur:
            <span class="ot">self</span>._longueur = valeur
        <span class="kw">else</span>:
            <span class="ot">self</span>._longueur = <span class="ot">self</span>._largeur
            <span class="ot">self</span>._largeur = valeur</code></pre>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; rect = Rectangle(<span class="dv">5</span>, <span class="dv">4</span>)
&gt;&gt;&gt; rect.set_longueur(<span class="dv">3</span>)
&gt;&gt;&gt; rect.get_longueur()
<span class="dv">4</span></code></pre>
</section>
<section id="lectureécriture-dattributs-1" class="level2">
<h2>Lecture/écriture d'attributs</h2>
<p>Ca marche, mais on voudrait faire mieux et pouvoir écrire :</p>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; rect = Rectangle(<span class="dv">5</span>, <span class="dv">4</span>)
&gt;&gt;&gt; rect.longueur = <span class="dv">3</span>
&gt;&gt;&gt; rect.longueur
<span class="dv">4</span></code></pre>
<ul>
<li>Décorateur sur les fonctions
<ul>
<li><code>@property</code> pour faire comme si la méthode était un attribut</li>
<li><code>@attribut.setter</code> pour faire comme si l'on affectait une valeur à l'attribut</li>
</ul></li>
</ul>
<p><br/></p>
<p style="font-size:16pt">
Remarque : plus généralement, un décorateur est quelque chose que l'on ajoute à une fonction pour en personnaliser le comportement (pré ou post-traitements, initialisation de paramètres...). Il en existe plein et on peut en définir soi-même.
</p>


</section>
<section id="lectureécriture-dattributs-2" class="level2">
<h2>Lecture/écriture d'attributs</h2>
<p>Le code devient :</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">class</span> Rectangle(<span class="dt">object</span>):
    <span class="kw">def</span> <span class="ot">__init__</span>(<span class="ot">self</span>, longueur, largeur):
        <span class="ot">self</span>._longueur = longueur
        <span class="ot">self</span>._largeur = largeur
    
    <span class="ot">@property</span>
    <span class="kw">def</span> longueur(<span class="ot">self</span>):
        <span class="kw">return</span> <span class="ot">self</span>._longueur

    <span class="ot">@longueur.setter</span>
    <span class="kw">def</span> longueur(<span class="ot">self</span>, valeur):
        <span class="kw">if</span> valeur &gt;= <span class="ot">self</span>._largeur:
            <span class="ot">self</span>._longueur = valeur
        <span class="kw">else</span>:
            <span class="ot">self</span>._longueur = <span class="ot">self</span>._largeur
            <span class="ot">self</span>._largeur = valeur</code></pre>
</section>
<section id="les-classes-abstraites" class="level2">
<h2>Les classes abstraites</h2>
<blockquote>
<p>Une classe abstraite est une classe qui ne peut être instanciée.</p>
</blockquote>
<ul>
<li>Notion difficile à mettre en oeuvre en Python</li>
<li>Astuce :
<ul>
<li>lever une exception dans le constructeur</li>
</ul></li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">class</span> MaClasseAbstraite(<span class="dt">object</span>):
    <span class="kw">def</span> <span class="ot">__init__</span>(<span class="ot">self</span>, param1, param2...):
        <span class="kw">raise</span> <span class="ot">NotImplementedError</span>

    <span class="kw">def</span> methode1(<span class="ot">self</span>, param...):
        <span class="co"># methode1 est une méthode abstraite</span>
        <span class="kw">raise</span> <span class="ot">NotImplementedError</span>

    <span class="kw">def</span> methode2(<span class="ot">self</span>, param...):
        <span class="co"># methode2 est une méthode concrète : on l&#39;implémente ici</span>
        ... </code></pre>
</section>
</section>
<section id="bases-de-données" class="level1">
<h1>Bases de données</h1>
<section id="sgbd-en-python" class="level2">
<h2>SGBD en Python</h2>
<ul>
<li>Intérêts
<ul>
<li>Persistance des données</li>
<li>Structuration des données</li>
</ul></li>
<li>Les solutions
<ul>
<li><code>sqlite</code></li>
<li><code>psycopg</code></li>
<li><code>mysql.connector</code></li>
<li>...</li>
<li><em>nombreuses librairies pour les SGBD les plus courants</em></li>
<li>API commune</li>
</ul></li>
</ul>
</section>
<section id="sqlite" class="level2">
<h2>SQLite</h2>
<ul>
<li>Base de données relationnelle (=&gt; SQL)</li>
<li>Pas d'architecture client-serveur traditionnelle</li>
</ul>
<figure>
<img src="img/sqlite_architecture.png" alt="Architecture SQLite - source Wikipedia" /><figcaption>Architecture SQLite - source Wikipedia</figcaption>
</figure>
<ul>
<li>BDD dans un seul fichier indépendant de la plateforme</li>
<li>Extension spatiale SpatiaLite</li>
<li>Exemples d'usage :
<ul>
<li>systèmes embarqués, profils Firefox...</li>
</ul></li>
</ul>
</section>
<section id="sqlite-en-python" class="level2">
<h2>SQLite en Python</h2>
<ul>
<li>Librairie standard de Python
<ul>
<li>rien besoin d'installer</li>
<li>la doc : <a href="https://docs.python.org/3/library/sqlite3.html">https://docs.python.org/3/library/sqlite3.html</a> </br></li>
</ul></li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ch">import</span> sqlite3</code></pre>
</section>
<section id="lobjet-connexion" class="level2">
<h2>L'objet connexion</h2>
<ul>
<li>Représente une connexion à une base de données</li>
<li>Interface pour valider ou annuler les transactions
<ul>
<li><em>commit</em> / <em>rollback</em></li>
<li>transaction = ensemble d'opérations SQL</li>
</ul></li>
<li>Génère des curseurs</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">conn = sqlite3.<span class="ot">connect</span>(<span class="st">&quot;user/password@database&quot;</span>)

conn.commit()    <span class="co"># valider transaction</span>
conn.rollback()  <span class="co"># annuler transaction</span>
conn.close()     <span class="co"># fermer la connection</span></code></pre>
</section>
<section id="syntaxe-avec-with" class="level2">
<h2>Syntaxe avec with</h2>
<ul>
<li>Idem que pour les fichiers</li>
<li>Pour éviter d'oublier de refermer la connexion</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">with</span> sqlite3.<span class="ot">connect</span>(<span class="st">&quot;user/password@database&quot;</span>) <span class="ch">as</span> conn:
    <span class="co"># requêtes dans la BDD</span></code></pre>
</section>
<section id="lobjet-curseur" class="level2">
<h2>L'objet curseur</h2>
<ul>
<li>Objet pour envoyer des requêtes SQL via la connection</li>
<li>Utilisé pour parcourir les résultats d'une requête SQL</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">curs = conn.cursor()

curs.execute(sql_string [, parameters])  <span class="co"># execute requete sql</span></code></pre>
</section>
<section id="requêtes-prises-en-charge" class="level2">
<h2>Requêtes prises en charge</h2>
<ul>
<li>Tous types de requêtes SQL acceptés</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">curs.execute(<span class="st">&quot;CREATE TABLE ...&quot;</span>)
curs.execute(<span class="st">&quot;UPDATE ...&quot;</span>)
curs.execute(<span class="st">&quot;INSERT INTO ...&quot;</span>)
curs.execute(<span class="st">&quot;SELECT ...&quot;</span>)
...</code></pre>
</section>
<section id="passage-de-paramètres" class="level2">
<h2>Passage de paramètres</h2>
<ul>
<li>Utilisation du caractère <code>?</code></li>
<li>Valeur des paramètres sous forme de tuple</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">query = <span class="st">&quot;SELECT nom, prenom FROM personne WHERE naissance &gt; ? AND sexe = ?&quot;</span>
curs.execute(query, (<span class="dv">2000</span>, <span class="st">&#39;M&#39;</span>))</code></pre>
</section>
<section id="résultats-des-requêtes-sql" class="level2">
<h2>Résultats des requêtes SQL</h2>
<ul>
<li>Séquence d'objets Python</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">curs.execute(select_query)
results = curs.fetchall()
<span class="kw">for</span> row in results:
    ...</code></pre>
</section>
<section id="exemples" class="level2">
<h2>Exemples</h2>
<ul>
<li><code>curs.rowcount</code> =&gt; nombre de lignes impactées par la dernière opération</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; <span class="ch">import</span> sqlite3
&gt;&gt;&gt; conn = sqlite3.<span class="ot">connect</span>(<span class="st">&#39;dbase1&#39;</span>)
&gt;&gt;&gt; curs = conn.cursor()
&gt;&gt;&gt; curs.execute(<span class="st">&#39;insert into people values (?, ?, ?)&#39;</span>, (<span class="st">&#39;Bob&#39;</span>, <span class="st">&#39;dev&#39;</span>, <span class="dv">5000</span>))
&gt;&gt;&gt; curs.rowcount
<span class="dv">1</span></code></pre>
</section>
<section id="exemples-1" class="level2">
<h2>Exemples</h2>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; rows = [[<span class="st">&#39;Tom&#39;</span>, <span class="st">&#39;mgr&#39;</span>, <span class="dv">100000</span>],
...         [<span class="st">&#39;Kim&#39;</span>, <span class="st">&#39;adm&#39;</span>, <span class="dv">30000</span>],
...         [<span class="st">&#39;Pat&#39;</span>, <span class="st">&#39;dev&#39;</span>, <span class="dv">90000</span>]]

&gt;&gt;&gt; <span class="kw">for</span> row in rows:
...     curs.execute(<span class="st">&#39;insert into people values (? , ?, ?)&#39;</span>, row)
...

&gt;&gt;&gt; conn.commit()</code></pre>
</section>
<section id="exemples-2" class="level2">
<h2>Exemples</h2>
<ul>
<li><code>fetchall()</code> =&gt; avoir tous les résultats d'un coup</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; curs.execute(<span class="st">&#39;select * from people&#39;</span>)
&gt;&gt;&gt; <span class="kw">for</span> row in curs.fetchall():
...     <span class="dt">print</span>(row)
...
(<span class="st">&#39;Bob&#39;</span>, <span class="st">&#39;dev&#39;</span>, <span class="dv">5000</span>)
(<span class="st">&#39;Sue&#39;</span>, <span class="st">&#39;mus&#39;</span>, <span class="dv">70000</span>)
(<span class="st">&#39;Ann&#39;</span>, <span class="st">&#39;mus&#39;</span>, <span class="dv">60000</span>)
(<span class="st">&#39;Tom&#39;</span>, <span class="st">&#39;mgr&#39;</span>, <span class="dv">100000</span>)
(<span class="st">&#39;Kim&#39;</span>, <span class="st">&#39;adm&#39;</span>, <span class="dv">30000</span>)
(<span class="st">&#39;Pat&#39;</span>, <span class="st">&#39;dev&#39;</span>, <span class="dv">90000</span>)</code></pre>
</section>
<section id="exemples-3" class="level2">
<h2>Exemples</h2>
<ul>
<li>Possibilité de ne retenir que certaines colonnes en Python</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; curs.execute(<span class="st">&#39;select * from people&#39;</span>)
&gt;&gt;&gt; <span class="kw">for</span> (name, job, pay) in curs.fetchall():
...     <span class="dt">print</span>(name, <span class="st">&#39;:&#39;</span>, pay)
...
Bob : <span class="dv">5000</span>
Sue : <span class="dv">70000</span>
Ann : <span class="dv">60000</span>
Tom : <span class="dv">100000</span>
Kim : <span class="dv">30000</span>
Pat : <span class="dv">90000</span></code></pre>
</section>
<section id="exemples-4" class="level2">
<h2>Exemples</h2>
<ul>
<li>Idem en utilisant la position des colonnes</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; curs.execute(<span class="st">&#39;select * from people&#39;</span>)
&gt;&gt;&gt; names = [rec[<span class="dv">0</span>] <span class="kw">for</span> rec in curs.fetchall()]
&gt;&gt;&gt; names
[<span class="st">&#39;Bob&#39;</span>, <span class="st">&#39;Sue&#39;</span>, <span class="st">&#39;Ann&#39;</span>, <span class="st">&#39;Tom&#39;</span>, <span class="st">&#39;Kim&#39;</span>, <span class="st">&#39;Pat&#39;</span>]</code></pre>
</section>
<section id="exemples-5" class="level2">
<h2>Exemples</h2>
<ul>
<li><code>fetchone()</code> =&gt; n'avoir qu'une ligne de résultat à la fois</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; curs.execute(<span class="st">&#39;select * from people&#39;</span>)
&gt;&gt;&gt; <span class="kw">while</span> <span class="ot">True</span>:
...     row = curs.fetchone()
...     <span class="kw">if</span> not row:
...         <span class="kw">break</span>
...     <span class="dt">print</span>(row)
...
(<span class="st">&#39;Bob&#39;</span>, <span class="st">&#39;dev&#39;</span>, <span class="dv">5000</span>)
(<span class="st">&#39;Sue&#39;</span>, <span class="st">&#39;mus&#39;</span>, <span class="dv">70000</span>)
(<span class="st">&#39;Ann&#39;</span>, <span class="st">&#39;mus&#39;</span>, <span class="dv">60000</span>)
(<span class="st">&#39;Tom&#39;</span>, <span class="st">&#39;mgr&#39;</span>, <span class="dv">100000</span>)
(<span class="st">&#39;Kim&#39;</span>, <span class="st">&#39;adm&#39;</span>, <span class="dv">30000</span>)
(<span class="st">&#39;Pat&#39;</span>, <span class="st">&#39;dev&#39;</span>, <span class="dv">90000</span>)</code></pre>
</section>
<section id="exemples-6" class="level2">
<h2>Exemples</h2>
<ul>
<li><code>curs.description</code> =&gt; description des colonnes</li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; curs.execute(<span class="st">&#39;select * from people&#39;</span>)
&gt;&gt;&gt; curs.description
((<span class="st">&#39;name&#39;</span>, <span class="ot">None</span>, <span class="ot">None</span>, <span class="ot">None</span>, <span class="ot">None</span>, <span class="ot">None</span>, <span class="ot">None</span>), (<span class="st">&#39;job&#39;</span>, <span class="ot">None</span>, <span class="ot">None</span>, <span class="ot">None</span>, <span class="ot">None</span>, <span class="ot">None</span>,
<span class="ot">None</span>), (<span class="st">&#39;pay&#39;</span>, <span class="ot">None</span>, <span class="ot">None</span>, <span class="ot">None</span>, <span class="ot">None</span>, <span class="ot">None</span>, <span class="ot">None</span>))</code></pre>
</section>
<section id="exemples-7" class="level2">
<h2>Exemples</h2>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; curs.execute(<span class="st">&#39;select * from people&#39;</span>)
&gt;&gt;&gt; colnames = [desc[<span class="dv">0</span>] <span class="kw">for</span> desc in curs.description]
&gt;&gt;&gt; <span class="kw">for</span> row in curs.fetchall():
...     <span class="kw">for</span> name, value in <span class="dt">zip</span>(colnames, row):
...         <span class="dt">print</span>(name, <span class="st">&#39;</span><span class="ch">\t</span><span class="st">=&gt;&#39;</span>, value)
...     <span class="dt">print</span>()
...
name =&gt; Sue
job  =&gt; mus
pay  =&gt; <span class="dv">70000</span>

name =&gt; Ann
job  =&gt; mus
pay  =&gt; <span class="dv">65000</span></code></pre>
</section>
<section id="exemples-8" class="level2">
<h2>Exemples</h2>
<ul>
<li>Possibilité de déporter en Python les calculs de grosses requêtes compliquées
<ul>
<li>mais attention à la mémoire et aux performances</li>
</ul></li>
</ul>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; query = (<span class="st">&quot;select name from people where job = &#39;devel&#39;&quot;</span>
...                <span class="st">&quot;and pay &gt; (select avg(pay) from people where job = &#39;devel&#39;)&quot;</span>)
&gt;&gt;&gt; curs.execute(query)
&gt;&gt;&gt; curs.fetchall()
[(<span class="st">&#39;Kim&#39;</span>,)]</code></pre>
<pre><code>&gt;&gt;&gt; curs.execute(&quot;select name, pay from people where job = &#39;devel&#39;&quot;)
&gt;&gt;&gt; result = curs.fetchall()
&gt;&gt;&gt; avg = sum(row[1] for row in result) / len(result)  # calcul du salaire moyen en python
&gt;&gt;&gt; print([rec[0] for rec in result if rec[1] &gt; avg])
[&#39;Kim&#39;]</code></pre>
</section>
<section id="orm" class="level2">
<h2>ORM</h2>
<ul>
<li>Object Relationnal Model</li>
<li>Couche intermédiaire entre le SGBD et le programme</li>
<li>Donner l'illustion de travailler avec une BDD orientée objets</li>
<li>Solution au problème du mapping objet/relationnel</li>
<li>Exemple
<ul>
<li>SQLAlchemy</li>
</ul></li>
</ul>
</section>
</section>
            </div>
        </div>

        <script type="text/javascript" src="reveal.js/lib/js/head.min.js"></script>
        <script type="text/javascript" src="reveal.js/js/reveal.js"></script>

        <script type="text/javascript">
            // Full list of configuration options available here:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                /* mettre une taille en pixel sinon l'overview ne fonctionne plus */
                width: 1024,
                height: 768,
                controls: true,                                 // Display controls in the bottom right corner
                progress: true,                                 // Display a presentation progress bar
                history: true,                                  // Push each slide change to the browser history
                center: false, // Vertical centering of slides
                minScale: 0.2, // Bounds for smallestpossible content scale
                maxScale: 1.5, // Bounds for largest possible content scale
                slideNumber: false, // Display the page number of the current slide
                autoSlide: 0, // Slide every duration milliseconds

                theme: 'default', // available themes are in /css/theme
                transition: 'default', // default/cube/page/concave/zoom/linear/fade/none

                // Optional libraries used to extend on reveal.js
                dependencies: [
                    { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    // { src: 'reveal.js/plugin/markdown/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    // { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    /* ne pas activer highlight sinon la colorisation syntaxique ne fonctionne plus ? */
                    // { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
                    { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }//,
                    // { src: 'reveal.js/plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } },
                    // { src: 'reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
                ]
            });

        </script>
        <!-- -A/- -include-after-body -->
        <!-- comme le footer contient des variables, on le met dans le gabarit car
             les variables ne sont pas interprétées via -A de pandoc -->
        <div id="slide-ign-footer">
            <div class="slide-ign-title">Python objet</div>
            <div class="slide-ign-date">2017</div>
        </div>
    </body>
</html>

